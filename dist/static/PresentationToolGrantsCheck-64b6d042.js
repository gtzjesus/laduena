import{aQ as Nr,r as m,aR as On,aS as qr,Y as Fr,Z as Vr,aT as Bt,aU as Kr,aV as rr,aW as sr,aX as Gt,aY as sn,aZ as Et,a_ as Pe,a$ as ft,b0 as Hr,al as an,b1 as Xt,b2 as ir,b3 as pn,b4 as Br,b5 as on,b6 as Gr,b7 as Xr,b8 as Jr,b9 as Qr,am as ar,ba as Yr,bb as hn,bc as or,h as pe,c as L,j as c,bd as Lt,be as bt,a3 as Ee,N as kt,T as W,o as xe,bf as we,n as cr,u as Dt,bg as Ut,bh as fn,bi as lr,p as be,bj as Zr,bk as dr,G as es,t as dt,bl as ur,B as te,S as je,C as oe,bm as pr,bn as ts,bo as cn,w as ns,F as J,bp as mn,bq as rs,br as hr,bs as Mn,bt as fr,bu as ss,m as At,k as $t,bv as is,bw as gn,bx as as,by as os,bz as cs,I as ls,a as ds,at as mr,bA as us,bB as ps,$ as vn,bC as gr,bD as hs,bE as fs,bF as ms,bG as gs,bH as vs,bI as zn,a9 as ys,bJ as bs,bK as xs,bL as ws,bM as vr,bN as _s,bO as Ss,bP as Ps,bQ as js,aK as Es,bR as yn,bS as yr,bT as Rs,bU as Ts,a5 as Cs,bV as Is,bW as ks,bX as As,aJ as $s,z as Os,bY as Ms,bZ as zs,b_ as Ls,b$ as Ds,c0 as Us,x as Ws,c1 as Ns,c2 as qs,c3 as Ln,c4 as Fs,c5 as Vs,c6 as Ks,c7 as Hs,c8 as br,ae as xr,c9 as Bs,ca as Gs,s as Xs,ai as Js,cb as Qs,cc as Ys}from"./sanity-3b6b2486.js";import{i as Zs,D as ei}from"./DisplayedDocumentBroadcaster-97a89245.js";function ti({children:t,isValidProp:e,...n}){e&&Nr(e),n={...m.useContext(On),...n},n.isStatic=qr(()=>n.isStatic);const s=m.useMemo(()=>n,[JSON.stringify(n.transition),n.transformPagePoint,n.reducedMotion]);return m.createElement(On.Provider,{value:s},t)}function ni(t,e){return e===void 0&&(e=null),e=e??t,Fr(function(n,s){var r=[],i=0;n.subscribe(Vr(s,function(a){var o,l,d,p,u=null;i++%e===0&&r.push([]);try{for(var f=Bt(r),h=f.next();!h.done;h=f.next()){var x=h.value;x.push(a),t<=x.length&&(u=u??[],u.push(x))}}catch(y){o={error:y}}finally{try{h&&!h.done&&(l=f.return)&&l.call(f)}finally{if(o)throw o.error}}if(u)try{for(var b=Bt(u),g=b.next();!g.done;g=b.next()){var x=g.value;Kr(r,x),s.next(x)}}catch(y){d={error:y}}finally{try{g&&!g.done&&(p=b.return)&&p.call(b)}finally{if(d)throw d.error}}},function(){var a,o;try{for(var l=Bt(r),d=l.next();!d.done;d=l.next()){var p=d.value;s.next(p)}}catch(u){a={error:u}}finally{try{d&&!d.done&&(o=l.return)&&o.call(l)}finally{if(a)throw a.error}}s.complete()},void 0,function(){r=null}))})}const Dn=new WeakMap;function ri(t){return{config:t,start:(n,s)=>{const{self:r,system:i,emit:a}=s,o={receivers:void 0,dispose:void 0};Dn.set(r,o),o.dispose=t({input:n.input,system:i,self:r,sendBack:l=>{r.getSnapshot().status!=="stopped"&&r._parent&&i._relay(r,r._parent,l)},receive:l=>{o.receivers??(o.receivers=new Set),o.receivers.add(l)},emit:a})},transition:(n,s,r)=>{var a,o;const i=Dn.get(r.self);return s.type===rr?(n={...n,status:"stopped",error:void 0},(a=i.dispose)==null||a.call(i),n):((o=i.receivers)==null||o.forEach(l=>l(s)),n)},getInitialSnapshot:(n,s)=>({status:"active",output:void 0,error:void 0,input:s}),getPersistedSnapshot:n=>n,restoreSnapshot:n=>n}}const Un="xstate.observable.error",Wn="xstate.observable.complete";function wr(t){return{config:t,transition:(n,s)=>{if(n.status!=="active")return n;switch(s.type){case Un:return{...n,status:"error",error:s.data,input:void 0,_subscription:void 0};case Wn:return{...n,status:"done",input:void 0,_subscription:void 0};case rr:return n._subscription.unsubscribe(),{...n,status:"stopped",input:void 0,_subscription:void 0};default:return n}},getInitialSnapshot:(n,s)=>({status:"active",output:void 0,error:void 0,context:void 0,input:s,_subscription:void 0}),start:(n,{self:s,system:r,emit:i})=>{n.status!=="done"&&(n._subscription=t({input:n.input,system:r,self:s,emit:i}).subscribe({next:a=>{s._parent&&r._relay(s,s._parent,a)},error:a=>{r._relay(s,s,{type:Un,data:a})},complete:()=>{r._relay(s,s,{type:Wn})}}))},getPersistedSnapshot:({_subscription:n,...s})=>s,restoreSnapshot:n=>({...n,_subscription:void 0})}}const bn="sanity.previewUrlSecret",si="sanity-preview-url-secret",$e=`${si}.share-access`,ut="sanity.previewUrlShareAccess",xn="2023-11-09",wn="sanity-preview-secret",_n="sanity-preview-pathname",Sn="sanity-preview-perspective",_r=60*60,ii=`*[_id == "${$e}" && _type == "${ut}"][0].secret`,ai=`*[_type == "${bn}" && dateTime(_updatedAt) <= dateTime(now()) - ${_r}]`,Pn="sanity.preview-url-secret";var Z=[];for(var Jt=0;Jt<256;++Jt)Z.push((Jt+256).toString(16).slice(1));function oi(t,e=0){return(Z[t[e+0]]+Z[t[e+1]]+Z[t[e+2]]+Z[t[e+3]]+"-"+Z[t[e+4]]+Z[t[e+5]]+"-"+Z[t[e+6]]+Z[t[e+7]]+"-"+Z[t[e+8]]+Z[t[e+9]]+"-"+Z[t[e+10]]+Z[t[e+11]]+Z[t[e+12]]+Z[t[e+13]]+Z[t[e+14]]+Z[t[e+15]]).toLowerCase()}var Rt,ci=new Uint8Array(16);function li(){if(!Rt&&(Rt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Rt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Rt(ci)}var di=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const Nn={randomUUID:di};function vt(t,e,n){if(Nn.randomUUID&&!e&&!t)return Nn.randomUUID();t=t||{};var s=t.random||(t.rng||li)();if(s[6]=s[6]&15|64,s[8]=s[8]&63|128,e){n=n||0;for(var r=0;r<16;++r)e[n+r]=s[r];return e}return oi(s)}const qn=t=>({context:e})=>{const{count:n,include:s,exclude:r,responseType:i="message.received"}=t;return{count:n,domain:e.domain,from:e.connectTo,include:s?Array.isArray(s)?s:[s]:[],exclude:r?Array.isArray(r)?r:[r]:[],responseType:i,target:e.target,to:e.name}},ui=t=>e=>{const{data:n}=e;return(t.include.length?t.include.includes(n.type):!0)&&(t.exclude.length?!t.exclude.includes(n.type):!0)&&n.domain===t.domain&&n.from===t.from&&n.to===t.to&&(!t.target||e.source===t.target)},pi=t=>e=>({type:t,message:e}),hi=Jr(()=>on(window,"message")),Sr=t=>wr(({input:e})=>hi.pipe(t?an(t):Xt(),ir(ui(e)),an(pi(e.responseType)),e.count?Xt(ni(e.count),Br(n=>n),pn(e.count)):Xt())),jn="sanity/comlink",fi=3e3,mi=500,yt="comlink/response",Ot="comlink/heartbeat",En="comlink/disconnect",Rn="comlink/handshake/syn",Tn="comlink/handshake/syn-ack",Cn="comlink/handshake/ack",gi=t=>e=>e.pipe(pn(1),an(()=>{throw new Error(t)})),Pr=()=>sr({types:{},actors:{listen:wr(({input:t})=>{const e=t.signal?on(t.signal,"abort").pipe(gi(`Request ${t.requestId} aborted`)):Gr,n=s=>{var r,i;return((r=s.data)==null?void 0:r.type)===yt&&((i=s.data)==null?void 0:i.responseTo)===t.requestId&&!!s.source&&t.sources.has(s.source)};return on(window,"message").pipe(ir(n),pn(t.sources.size),Xr(e))})},actions:{"send message":({context:t},e)=>{const{sources:n,targetOrigin:s}=t,{message:r}=e;n.forEach(i=>{i.postMessage(r,{targetOrigin:s})})},"on success":Gt(({context:t})=>t.parentRef,({context:t,self:e})=>{var n;return t.response&&((n=t.resolvable)==null||n.resolve(t.response)),{type:"request.success",requestId:e.id,response:t.response,responseTo:t.responseTo}}),"on fail":Gt(({context:t})=>t.parentRef,({context:t,self:e})=>{var n;return t.suppressWarnings||console.warn(`[@sanity/comlink] Received no response to message '${t.type}' on client '${t.from}' (ID: '${t.id}').`),(n=t.resolvable)==null||n.reject(new Error("No response received")),{type:"request.failed",requestId:e.id}}),"on abort":Gt(({context:t})=>t.parentRef,({context:t,self:e})=>{var n;return(n=t.resolvable)==null||n.reject(new Error("Request aborted")),{type:"request.aborted",requestId:e.id}})},guards:{expectsResponse:({context:t})=>t.expectResponse},delays:{initialTimeout:0,responseTimeout:({context:t})=>t.responseTimeout??fi}}).createMachine({context:({input:t})=>({connectionId:t.connectionId,data:t.data,domain:t.domain,expectResponse:t.expectResponse??!1,from:t.from,id:`msg-${vt()}`,parentRef:t.parentRef,resolvable:t.resolvable,response:null,responseTimeout:t.responseTimeout,responseTo:t.responseTo,signal:t.signal,sources:t.sources instanceof Set?t.sources:new Set([t.sources]),suppressWarnings:t.suppressWarnings,targetOrigin:t.targetOrigin,to:t.to,type:t.type}),initial:"idle",on:{abort:".aborted"},states:{idle:{after:{initialTimeout:[{target:"sending"}]}},sending:{entry:{type:"send message",params:({context:t})=>{const{connectionId:e,data:n,domain:s,from:r,id:i,responseTo:a,to:o,type:l}=t;return{message:{connectionId:e,data:n,domain:s,from:r,id:i,to:o,type:l,responseTo:a}}}},always:[{guard:"expectsResponse",target:"awaiting"},"success"]},awaiting:{invoke:{id:"listen for response",src:"listen",input:({context:t})=>({requestId:t.id,sources:t.sources,signal:t.signal}),onError:"aborted"},after:{responseTimeout:"failed"},on:{message:{actions:sn({response:({event:t})=>t.data.data,responseTo:({event:t})=>t.data.responseTo}),target:"success"}}},failed:{type:"final",entry:"on fail"},success:{type:"final",entry:"on success"},aborted:{type:"final",entry:"on abort"}},output:({context:t,self:e})=>({requestId:e.id,response:t.response,responseTo:t.responseTo})}),vi=ri(({sendBack:t,input:e})=>{const n=()=>{t(e.event)};e.immediate&&n();const s=setInterval(n,e.interval);return()=>{clearInterval(s)}}),Mt=()=>sr({types:{},actors:{requestMachine:Pr(),listen:Sr(),sendBackAtInterval:vi},actions:{"buffer message":Et(({enqueue:t})=>{t.assign({buffer:({event:e,context:n})=>(Pe(e,"post"),[...n.buffer,e.data])}),t.emit(({event:e})=>(Pe(e,"post"),{type:"_buffer.added",message:e.data}))}),"create request":sn({requests:({context:t,event:e,self:n,spawn:s})=>{Pe(e,"request");const r=(Array.isArray(e.data)?e.data:[e.data]).map(i=>{const a=`req-${vt()}`;return s("requestMachine",{id:a,input:{connectionId:t.connectionId,data:i.data,domain:t.domain,expectResponse:i.expectResponse,from:t.name,parentRef:n,responseTo:i.responseTo,sources:t.target,targetOrigin:t.targetOrigin,to:t.connectTo,type:i.type}})});return[...t.requests,...r]}}),"emit received message":Et(({enqueue:t})=>{t.emit(({event:e})=>(Pe(e,"message.received"),{type:"_message",message:e.message.data})),t.emit(({event:e})=>(Pe(e,"message.received"),{type:e.message.data.type,message:e.message.data}))}),"flush buffer":Et(({enqueue:t})=>{t.raise(({context:e})=>({type:"request",data:e.buffer.map(({data:n,type:s})=>({data:n,type:s}))})),t.emit(({context:e})=>({type:"_buffer.flushed",messages:e.buffer})),t.assign({buffer:[]})}),post:ft(({event:t})=>(Pe(t,"post"),{type:"request",data:{data:t.data.data,expectResponse:!0,type:t.data.type}})),"remove request":Et(({context:t,enqueue:e,event:n})=>{Pe(n,["request.success","request.failed","request.aborted"]),Hr(n.requestId),e.assign({requests:t.requests.filter(({id:s})=>s!==n.requestId)})}),respond:ft(({event:t})=>(Pe(t,"response"),{type:"request",data:{data:t.data,type:yt,responseTo:t.respondTo}})),"send handshake ack":ft({type:"request",data:{type:Cn}}),"send disconnect":ft(()=>({type:"request",data:{type:En}})),"send handshake syn":ft({type:"request",data:{type:Rn}}),"set target":sn({target:({event:t})=>(Pe(t,"target.set"),t.target)})},guards:{"has target":({context:t})=>!!t.target,"should send heartbeats":({context:t})=>t.heartbeat}}).createMachine({id:"channel",context:({input:t})=>({id:t.id||`${t.name}-${vt()}`,buffer:[],connectionId:`cnx-${vt()}`,connectTo:t.connectTo,domain:t.domain??jn,heartbeat:t.heartbeat??!1,name:t.name,requests:[],target:t.target,targetOrigin:t.targetOrigin}),on:{"target.set":{actions:"set target"},"request.success":{actions:"remove request"},"request.failed":{actions:"remove request"}},initial:"idle",states:{idle:{on:{connect:{target:"handshaking",guard:"has target"},post:{actions:"buffer message"}}},handshaking:{id:"handshaking",invoke:[{id:"send syn",src:"sendBackAtInterval",input:()=>({event:{type:"syn"},interval:mi,immediate:!0})},{id:"listen for handshake",src:"listen",input:t=>qn({include:Tn,count:1})(t)}],on:{syn:{actions:"send handshake syn"},request:{actions:"create request"},post:{actions:"buffer message"},"message.received":{target:"connected"},disconnect:{target:"disconnected"}},exit:"send handshake ack"},connected:{entry:"flush buffer",invoke:{id:"listen for messages",src:"listen",input:qn({exclude:[yt,Ot]})},on:{post:{actions:"post"},request:{actions:"create request"},response:{actions:"respond"},"message.received":{actions:"emit received message"},disconnect:{target:"disconnected"}},initial:"heartbeat",states:{heartbeat:{initial:"checking",states:{checking:{always:{guard:"should send heartbeats",target:"sending"}},sending:{on:{"request.failed":{target:"#handshaking"}},invoke:{id:"send heartbeat",src:"sendBackAtInterval",input:()=>({event:{type:"post",data:{type:Ot,data:void 0}},interval:2e3,immediate:!1})}}}}}},disconnected:{id:"disconnected",entry:"send disconnect",on:{request:{actions:"create request"},post:{actions:"buffer message"},connect:{target:"handshaking",guard:"has target"}}}}}),Qt=(t,e=Mt())=>{const n=t.id||`${t.name}-${vt()}`,s=Qr(e,{input:{...t,id:n}}),r=(f,h)=>{const{unsubscribe:x}=s.on(f,async b=>{const g=await h(b.message.data);g&&s.send({type:"response",respondTo:b.message.id,data:g})});return x},i=()=>{s.send({type:"connect"})},a=()=>{s.send({type:"disconnect"})},o=f=>{const h=s.getSnapshot();let x=typeof h.value=="string"?h.value:Object.keys(h.value)[0];const{unsubscribe:b}=s.subscribe(g=>{const y=typeof g.value=="string"?g.value:Object.keys(g.value)[0];x!==y&&(x=y,f(y))});return b},l=f=>{s.send({type:"target.set",target:f})},d=f=>{s.send({type:"post",data:f})},p=()=>{s.stop()},u=()=>(s.start(),p);return{actor:s,connect:i,disconnect:a,id:n,name:t.name,machine:e,on:r,onStatus:o,post:d,setTarget:l,start:u,stop:p,get target(){return s.getSnapshot().context.target}}},Yt=t=>{t.disconnect(),setTimeout(()=>{t.stop()},0)},yi=()=>{},bi=t=>{const{targetOrigin:e}=t,n=new Set,s=new Set;return{addTarget:r=>{if(n.has(r))return yi;if(!n.size||!s.size)return n.add(r),s.forEach(a=>{a.channels.forEach(o=>{o.setTarget(r),o.connect()})}),()=>{n.delete(r),s.forEach(a=>{a.channels.forEach(o=>{o.target===r&&o.disconnect()})})};n.add(r);const i=new Set;return s.forEach(a=>{const o=Qt({...a.input,target:r,targetOrigin:e},a.machine);i.add(o),a.channels.add(o),a.subscribers.forEach(({type:l,handler:d,unsubscribers:p})=>{p.push(o.on(l,d))}),a.internalEventSubscribers.forEach(({type:l,handler:d,unsubscribers:p})=>{p.push(o.actor.on(l,d).unsubscribe)}),a.statusSubscribers.forEach(({handler:l,unsubscribers:d})=>{d.push(o.onStatus(p=>l({channel:o.id,status:p})))}),o.start(),o.connect()}),()=>{n.delete(r),i.forEach(a=>{Yt(a),s.forEach(o=>{o.channels.delete(a)})})}},createConnection:(r,i=Mt())=>{const a={channels:new Set,input:r,internalEventSubscribers:new Set,machine:i,statusSubscribers:new Set,subscribers:new Set};s.add(a);const{channels:o,internalEventSubscribers:l,statusSubscribers:d,subscribers:p}=a;if(n.size)n.forEach(g=>{const y=Qt({...r,target:g,targetOrigin:e},i);o.add(y)});else{const g=Qt({...r,targetOrigin:e},i);o.add(g)}const u=g=>{o.forEach(y=>{y.post(g)})},f=(g,y)=>{const _=[];o.forEach(w=>{_.push(w.on(g,y))});const S={type:g,handler:y,unsubscribers:_};return p.add(S),()=>{_.forEach(w=>w()),p.delete(S)}},h=(g,y)=>{const _=[];o.forEach(w=>{_.push(w.actor.on(g,y).unsubscribe)});const S={type:g,handler:y,unsubscribers:_};return l.add(S),()=>{_.forEach(w=>w()),l.delete(S)}},x=g=>{const y=[];o.forEach(S=>{y.push(S.onStatus(w=>g({channel:S.id,status:w})))});const _={handler:g,unsubscribers:y};return d.add(_),()=>{y.forEach(S=>S()),d.delete(_)}},b=()=>{const g=a.channels;g.forEach(Yt),g.clear(),s.delete(a)};return{on:f,onInternalEvent:h,onStatus:x,post:u,start:()=>(o.forEach(g=>{g.start(),g.connect()}),b),stop:b}},destroy:()=>{s.forEach(({channels:r})=>{r.forEach(Yt),r.clear()}),s.clear(),n.clear()}}},xi=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,In=/_key\s*==\s*['"](.*)['"]/,wi=/^\d*:\d*$/;function kn(t){return typeof t=="number"||typeof t=="string"&&/^\[\d+\]$/.test(t)}function Wt(t){return typeof t=="string"?In.test(t.trim()):typeof t=="object"&&"_key"in t}function jr(t){if(typeof t=="string"&&wi.test(t))return!0;if(!Array.isArray(t)||t.length!==2)return!1;const[e,n]=t;return(typeof e=="number"||e==="")&&(typeof n=="number"||n==="")}function _i(t,e,n){const s=typeof e=="string"?Er(e):e;if(!Array.isArray(s))throw new Error("Path must be an array or a string");let r=t;for(let i=0;i<s.length;i++){const a=s[i];if(kn(a)){if(!Array.isArray(r))return n;r=r[a]}if(Wt(a)){if(!Array.isArray(r))return n;r=r.find(o=>o._key===a._key)}if(typeof a=="string"&&(r=typeof r=="object"&&r!==null?r[a]:void 0),typeof r>"u")return n}return r}function Si(t){if(!Array.isArray(t))throw new Error("Path is not an array");return t.reduce((e,n,s)=>{const r=typeof n;if(r==="number")return`${e}[${n}]`;if(r==="string")return`${e}${s===0?"":"."}${n}`;if(Wt(n)&&n._key)return`${e}[_key=="${n._key}"]`;if(Array.isArray(n)){const[i,a]=n;return`${e}[${i}:${a}]`}throw new Error(`Unsupported path segment \`${JSON.stringify(n)}\``)},"")}function Er(t){if(typeof t!="string")throw new Error("Path is not a string");const e=t.match(xi);if(!e)throw new Error("Invalid path string");return e.map(Pi)}function Pi(t){return kn(t)?ji(t):Wt(t)?Ei(t):jr(t)?Ri(t):t}function ji(t){return Number(t.replace(/[^\d]/g,""))}function Ei(t){return{_key:t.match(In)[1]}}function Ri(t){const[e,n]=t.split(":").map(s=>s===""?s:Number(s));return[e,n]}var Rr=Object.freeze({__proto__:null,fromString:Er,get:_i,isIndexSegment:kn,isIndexTuple:jr,isKeySegment:Wt,reKeySegment:In,toString:Si});const Fn="drafts.";function oc(t){return t.startsWith(Fn)?t.slice(Fn.length):t}const Vn={"\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","'":"\\'","\\":"\\\\"},Kn={"\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	","\\'":"'","\\\\":"\\"};function Ti(t){return`$${t.map(e=>typeof e=="string"?`['${e.replace(/[\f\n\r\t'\\]/g,n=>Vn[n])}']`:typeof e=="number"?`[${e}]`:e._key!==""?`[?(@._key=='${e._key.replace(/['\\]/g,n=>Vn[n])}')]`:`[${e._index}]`).join("")}`}function cc(t){const e=[],n=/\['(.*?)'\]|\[(\d+)\]|\[\?\(@\._key=='(.*?)'\)\]/g;let s;for(;(s=n.exec(t))!==null;){if(s[1]!==void 0){const r=s[1].replace(/\\(\\|f|n|r|t|')/g,i=>Kn[i]);e.push(r);continue}if(s[2]!==void 0){e.push(parseInt(s[2],10));continue}if(s[3]!==void 0){const r=s[3].replace(/\\(\\')/g,i=>Kn[i]);e.push({_key:r,_index:-1});continue}}return e}function Ci(t){return t.map(e=>{if(typeof e=="string"||typeof e=="number")return e;if(e._index!==-1)return e._index;throw new Error(`invalid segment:${JSON.stringify(e)}`)})}function lc(t,e){if(!(e!=null&&e.mappings))return;const n=Ti(Ci(t));if(e.mappings[n]!==void 0)return{mapping:e.mappings[n],matchedPath:n,pathSuffix:""};const s=Object.entries(e.mappings).filter(([o])=>n.startsWith(o)).sort(([o],[l])=>l.length-o.length);if(s.length==0)return;const[r,i]=s[0],a=n.substring(r.length);return{mapping:i,matchedPath:r,pathSuffix:a}}function Ii(t){return t!==null&&Array.isArray(t)}function Hn(t){return typeof t=="object"&&t!==null}function mt(t,e,n=[]){if(Ii(t))return t.map((s,r)=>{if(Hn(s)){const i=s._key;if(typeof i=="string")return mt(s,e,n.concat({_key:i,_index:r}))}return mt(s,e,n.concat(r))});if(Hn(t)){if(t._type==="block"||t._type==="span"){const s={...t};return t._type==="block"?s.children=mt(t.children,e,n.concat("children")):t._type==="span"&&(s.text=mt(t.text,e,n.concat("text"))),s}return Object.fromEntries(Object.entries(t).map(([s,r])=>[s,mt(r,e,n.concat(s))]))}return e(t,n)}function ki(t){const e=new URL(t),{searchParams:n}=e;return n.delete(_n),n.delete(wn),n.delete(Sn),e}function Ai(t,e,n,s){const r=new URL(t),{searchParams:i}=r;return i.set(wn,e),i.set(_n,n),i.set(Sn,s),r}function Tr(){if(typeof crypto<"u"){const t=new Uint8Array(16);crypto.getRandomValues(t);let e="";for(let n=0;n<t.length;n++)e+=t[n].toString(16).padStart(2,"0");return e=btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/[=]+$/,""),e}return Math.random().toString(36).slice(2)}async function $i(t,e,n,s){const r=t.withConfig({apiVersion:xn}),i=Tr(),a=r.patch($e).set({secret:i,studioUrl:n,userId:s});return await r.transaction().createIfNotExists({_id:$e,_type:ut,source:e,studioUrl:n,userId:s}).patch(a).commit({tag:Pn}),{secret:i}}async function Oi(t,e,n,s){const r=t.withConfig({apiVersion:xn}),i=r.patch($e).set({secret:null,studioUrl:n,userId:s});await r.transaction().createIfNotExists({_id:$e,_type:ut,source:e,studioUrl:n,userId:s}).patch(i).commit({tag:Pn})}function Mi(t){for(var e=[],n=0;n<t.length;){var s=t[n];if(s==="*"||s==="+"||s==="?"){e.push({type:"MODIFIER",index:n,value:t[n++]});continue}if(s==="\\"){e.push({type:"ESCAPED_CHAR",index:n++,value:t[n++]});continue}if(s==="{"){e.push({type:"OPEN",index:n,value:t[n++]});continue}if(s==="}"){e.push({type:"CLOSE",index:n,value:t[n++]});continue}if(s===":"){for(var r="",i=n+1;i<t.length;){var a=t.charCodeAt(i);if(a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122||a===95){r+=t[i++];continue}break}if(!r)throw new TypeError("Missing parameter name at ".concat(n));e.push({type:"NAME",index:n,value:r}),n=i;continue}if(s==="("){var o=1,l="",i=n+1;if(t[i]==="?")throw new TypeError('Pattern cannot start with "?" at '.concat(i));for(;i<t.length;){if(t[i]==="\\"){l+=t[i++]+t[i++];continue}if(t[i]===")"){if(o--,o===0){i++;break}}else if(t[i]==="("&&(o++,t[i+1]!=="?"))throw new TypeError("Capturing groups are not allowed at ".concat(i));l+=t[i++]}if(o)throw new TypeError("Unbalanced pattern at ".concat(n));if(!l)throw new TypeError("Missing pattern at ".concat(n));e.push({type:"PATTERN",index:n,value:l}),n=i;continue}e.push({type:"CHAR",index:n,value:t[n++]})}return e.push({type:"END",index:n,value:""}),e}function zi(t,e){e===void 0&&(e={});for(var n=Mi(t),s=e.prefixes,r=s===void 0?"./":s,i=e.delimiter,a=i===void 0?"/#?":i,o=[],l=0,d=0,p="",u=function(v){if(d<n.length&&n[d].type===v)return n[d++].value},f=function(v){var P=u(v);if(P!==void 0)return P;var k=n[d],C=k.type,$=k.index;throw new TypeError("Unexpected ".concat(C," at ").concat($,", expected ").concat(v))},h=function(){for(var v="",P;P=u("CHAR")||u("ESCAPED_CHAR");)v+=P;return v},x=function(v){for(var P=0,k=a;P<k.length;P++){var C=k[P];if(v.indexOf(C)>-1)return!0}return!1},b=function(v){var P=o[o.length-1],k=v||(P&&typeof P=="string"?P:"");if(P&&!k)throw new TypeError('Must have text between two parameters, missing text after "'.concat(P.name,'"'));return!k||x(k)?"[^".concat(Ae(a),"]+?"):"(?:(?!".concat(Ae(k),")[^").concat(Ae(a),"])+?")};d<n.length;){var g=u("CHAR"),y=u("NAME"),_=u("PATTERN");if(y||_){var S=g||"";r.indexOf(S)===-1&&(p+=S,S=""),p&&(o.push(p),p=""),o.push({name:y||l++,prefix:S,suffix:"",pattern:_||b(S),modifier:u("MODIFIER")||""});continue}var w=g||u("ESCAPED_CHAR");if(w){p+=w;continue}p&&(o.push(p),p="");var j=u("OPEN");if(j){var S=h(),E=u("NAME")||"",T=u("PATTERN")||"",R=h();f("CLOSE"),o.push({name:E||(T?l++:""),pattern:E&&!T?b(S):T,prefix:S,suffix:R,modifier:u("MODIFIER")||""});continue}f("END")}return o}function Li(t,e){var n=[],s=Ir(t,n,e);return Di(s,n,e)}function Di(t,e,n){n===void 0&&(n={});var s=n.decode,r=s===void 0?function(i){return i}:s;return function(i){var a=t.exec(i);if(!a)return!1;for(var o=a[0],l=a.index,d=Object.create(null),p=function(f){if(a[f]===void 0)return"continue";var h=e[f-1];h.modifier==="*"||h.modifier==="+"?d[h.name]=a[f].split(h.prefix+h.suffix).map(function(x){return r(x,h)}):d[h.name]=r(a[f],h)},u=1;u<a.length;u++)p(u);return{path:o,index:l,params:d}}}function Ae(t){return t.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function Cr(t){return t&&t.sensitive?"":"i"}function Ui(t,e){if(!e)return t;for(var n=/\((?:\?<(.*?)>)?(?!\?)/g,s=0,r=n.exec(t.source);r;)e.push({name:r[1]||s++,prefix:"",suffix:"",modifier:"",pattern:""}),r=n.exec(t.source);return t}function Wi(t,e,n){var s=t.map(function(r){return Ir(r,e,n).source});return new RegExp("(?:".concat(s.join("|"),")"),Cr(n))}function Ni(t,e,n){return qi(zi(t,n),e,n)}function qi(t,e,n){n===void 0&&(n={});for(var s=n.strict,r=s===void 0?!1:s,i=n.start,a=i===void 0?!0:i,o=n.end,l=o===void 0?!0:o,d=n.encode,p=d===void 0?function(P){return P}:d,u=n.delimiter,f=u===void 0?"/#?":u,h=n.endsWith,x=h===void 0?"":h,b="[".concat(Ae(x),"]|$"),g="[".concat(Ae(f),"]"),y=a?"^":"",_=0,S=t;_<S.length;_++){var w=S[_];if(typeof w=="string")y+=Ae(p(w));else{var j=Ae(p(w.prefix)),E=Ae(p(w.suffix));if(w.pattern)if(e&&e.push(w),j||E)if(w.modifier==="+"||w.modifier==="*"){var T=w.modifier==="*"?"?":"";y+="(?:".concat(j,"((?:").concat(w.pattern,")(?:").concat(E).concat(j,"(?:").concat(w.pattern,"))*)").concat(E,")").concat(T)}else y+="(?:".concat(j,"(").concat(w.pattern,")").concat(E,")").concat(w.modifier);else{if(w.modifier==="+"||w.modifier==="*")throw new TypeError('Can not repeat "'.concat(w.name,'" without a prefix and suffix'));y+="(".concat(w.pattern,")").concat(w.modifier)}else y+="(?:".concat(j).concat(E,")").concat(w.modifier)}}if(l)r||(y+="".concat(g,"?")),y+=n.endsWith?"(?=".concat(b,")"):"$";else{var R=t[t.length-1],v=typeof R=="string"?g.indexOf(R[R.length-1])>-1:R===void 0;r||(y+="(?:".concat(g,"(?=").concat(b,"))?")),v||(y+="(?=".concat(g,"|").concat(b,")"))}return new RegExp(y,Cr(n))}function Ir(t,e,n){return t instanceof RegExp?Ui(t,e):Array.isArray(t)?Wi(t,e,n):Ni(t,e,n)}async function Fi(t,e,n,s,r=ar()){const i=t.withConfig({apiVersion:xn});try{const a=new Date(Date.now()+1e3*_r),o=`drafts.${r}`,l=Tr(),d=i.patch(o).set({secret:l,source:e,studioUrl:n,userId:s});return await i.transaction().createOrReplace({_id:o,_type:bn}).patch(d).commit({tag:Pn}),{secret:l,expiresAt:a}}finally{try{await i.delete({query:ai})}catch(a){console.error("Failed to delete expired secrets",a)}}}function Vi(t){const{draftMode:e,previewMode:n,origin:s=typeof location>"u"?"https://localhost":location.origin}=t,r=(n==null?void 0:n.enable)||(e==null?void 0:e.enable);let{preview:i="/"}=t;const a=new URL(i,s),o=r?new URL(r,s):void 0;return async l=>{try{if(l.previewSearchParam){const p=new URL(l.previewSearchParam,a);p.origin===a.origin&&(i=`${p.pathname}${p.search}`)}}catch{}typeof location<"u"&&location.origin===a.origin&&l.studioBasePath&&(i.startsWith(`${l.studioBasePath}/`)||i===l.studioBasePath)&&(i=t.preview||"/");const d=new URL(i,a);if(o){const p=new URL(o),{searchParams:u}=p;return u.set(wn,l.previewUrlSecret),u.set(Sn,l.studioPreviewPerspective),d.pathname!==p.pathname&&u.set(_n,`${d.pathname}${d.search}`),p.toString()}return d.toString()}}const Ki=t=>typeof t=="object"&&typeof t.then=="function",Tt=[];function Hi(t,e,n=(s,r)=>s===r){if(t===e)return!0;if(!t||!e)return!1;const s=t.length;if(e.length!==s)return!1;for(let r=0;r<s;r++)if(!n(t[r],e[r]))return!1;return!0}function Bi(t,e=null,n=!1,s={}){e===null&&(e=[t]);for(const i of Tt)if(Hi(e,i.keys,i.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(i,"error"))throw i.error;if(Object.prototype.hasOwnProperty.call(i,"response"))return s.lifespan&&s.lifespan>0&&(i.timeout&&clearTimeout(i.timeout),i.timeout=setTimeout(i.remove,s.lifespan)),i.response;if(!n)throw i.promise}const r={keys:e,equal:s.equal,remove:()=>{const i=Tt.indexOf(r);i!==-1&&Tt.splice(i,1)},promise:(Ki(t)?t:t(...e)).then(i=>{r.response=i,s.lifespan&&s.lifespan>0&&(r.timeout=setTimeout(r.remove,s.lifespan))}).catch(i=>r.error=i)};if(Tt.push(r),!n)throw r.promise}const kr=(t,e,n)=>Bi(t,e,!1,n),Gi=/^([\w-]+):(0|[1-9][0-9]*)$/,Xi=/^([\w-]+):([0-9]+),([0-9]+)$/,Ji=/^([\w-]+):([\w-]+)$/;function Qi(t){const e=[];for(const n of t.split(".")){const s=Gi.exec(n);if(s){e.push(s[1],Number(s[2]));continue}const r=Xi.exec(n);if(r){e.push(r[1],[Number(r[2]),Number(r[3])]);continue}const i=Ji.exec(n);if(i){e.push(i[1],{_key:i[2]});continue}e.push(n)}return e}const pt=Yr(gn(),is(1)),gt=hn(pt);or({baseUrl:pt,dataset:gt,id:pt,path:pt,projectId:gt,tool:gt,type:gt,workspace:gt,isDraft:hn(gn())});or({origin:pt,href:pt,data:hn(as(gn(),cs()))});const Yi={"handshake/syn":Rn,"handshake/syn-ack":Tn,"handshake/ack":Cn,"channel/response":yt,"channel/heartbeat":Ot,"channel/disconnect":En,"overlay/focus":"visual-editing/focus","overlay/navigate":"visual-editing/navigate","overlay/toggle":"visual-editing/toggle","presentation/toggleOverlay":"presentation/toggle-overlay"},Zi={[Rn]:"handshake/syn",[Tn]:"handshake/syn-ack",[Cn]:"handshake/ack",[yt]:"channel/response",[Ot]:"channel/heartbeat",[En]:"channel/disconnect","visual-editing/focus":"overlay/focus","visual-editing/navigate":"overlay/navigate","visual-editing/toggle":"overlay/toggle","presentation/toggle-overlay":"presentation/toggleOverlay"},ea=t=>{const{data:e}=t;return e&&typeof e=="object"&&"domain"in e&&"type"in e&&"from"in e&&"to"in e&&(e.domain==="sanity/channels"&&(e.domain=jn),e.to==="overlays"&&(e.to="visual-editing"),e.from==="overlays"&&(e.from="visual-editing"),e.type=Yi[e.type]??e.type),t},ta=t=>(t.domain===jn&&(t.domain="sanity/channels"),t.to==="visual-editing"&&(t.to="overlays"),t.from==="visual-editing"&&(t.from="overlays"),t.type=Zi[t.type]??t.type,t.type==="channel/response"&&t.responseTo&&!t.data&&(t.data={responseTo:t.responseTo}),(t.type==="handshake/syn"||t.type==="handshake/syn-ack"||t.type==="handshake/ack")&&(t.data={id:t.connectionId}),t),na=({context:t},e)=>{const{sources:n,targetOrigin:s}=t,r=ta(e.message);n.forEach(i=>{i.postMessage(r,{targetOrigin:s})})},ln=()=>({listen:Sr(ea),requestMachine:Pr().provide({actions:{"send message":na}})});function ra(t,e){return`${t}-${typeof e=="string"?e:JSON.stringify(e)}`}const sa=typeof window<"u"&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),Bn={alt:"altKey",ctrl:"ctrlKey",mod:sa?"metaKey":"ctrlKey",shift:"shiftKey"};function ia(t,e){return t.every(n=>Bn[n]?e[Bn[n]]:e.key===n.toUpperCase())}function Gn(t){return t.key==="Alt"}function Ar(t,e){let n;return(...s)=>{clearTimeout(n),n=setTimeout(()=>{t.apply(t,s)},e)}}const aa=function(t){const e=L(14),{comlink:n,children:s}=t;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r={},e[0]=r):r=e[0];const i=m.useRef(r);let a,o;e[1]!==n?(a=()=>n==null?void 0:n.on("visual-editing/shared-state",()=>({state:i.current})),o=[n],e[1]=n,e[2]=a,e[3]=o):(a=e[2],o=e[3]),m.useEffect(a,o);let l;e[4]!==n?(l=(g,y)=>{i.current[g]=y,n==null||n.post({type:"presentation/shared-state",data:{key:g,value:y}})},e[4]=n,e[5]=l):l=e[5];const d=l;let p;e[6]!==n?(p=g=>{n==null||n.post({type:"presentation/shared-state",data:{key:g}}),delete i.current[g]},e[6]=n,e[7]=p):p=e[7];const u=p;let f,h;e[8]!==u||e[9]!==d?(h={removeValue:u,setValue:d},e[8]=u,e[9]=d,e[10]=h):h=e[10],f=h;const x=f;let b;return e[11]!==s||e[12]!==x?(b=c.jsx(_s.Provider,{value:x,children:s}),e[11]=s,e[12]=x,e[13]=b):b=e[13],b},Nt=m.createContext(null);Nt.displayName="PanelsContext";const oa=pe.div`
  overflow: hidden;
  flex-basis: 0;
  flex-shrink: 1;
`,An=function(t){const e=L(15),{children:n,defaultSize:s,id:r,minWidth:i,maxWidth:a,order:o}=t,l=s===void 0?null:s,d=o===void 0?0:o,p=m.useContext(Nt);if(p===null)throw Error("Panel components must be rendered within a PanelGroup container");const{getPanelStyle:u,registerElement:f,unregisterElement:h}=p;let x;e[0]!==u||e[1]!==r?(x=u(r),e[0]=u,e[1]=r,e[2]=x):x=e[2];const b=x;let g,y;e[3]!==l||e[4]!==r||e[5]!==a||e[6]!==i||e[7]!==d||e[8]!==f||e[9]!==h?(g=()=>(f(r,{id:r,type:"panel",defaultSize:l,maxWidth:a??null,minWidth:i??0,order:d}),()=>{h(r)}),y=[r,l,d,a,i,f,h],e[3]=l,e[4]=r,e[5]=a,e[6]=i,e[7]=d,e[8]=f,e[9]=h,e[10]=g,e[11]=y):(g=e[10],y=e[11]),m.useLayoutEffect(g,y);let _;return e[12]!==n||e[13]!==b?(_=c.jsx(oa,{style:b,children:n}),e[12]=n,e[13]=b,e[14]=_):_=e[14],_},$r="presentation/panels",Or=()=>JSON.parse(localStorage.getItem($r)||"{}"),ca=t=>{localStorage.setItem($r,JSON.stringify(t))},Mr=t=>t.map(e=>[e.id,e.order].join(":")).join(",");function la(){const t=L(1);let e;const n=ua,s=da;let r;if(t[0]===Symbol.for("react.memo_cache_sentinel")){const i=Ar(s,100);r={get:n,set:s,setDebounced:i},t[0]=r}else r=t[0];return e=r,e}function da(t,e){const n=Or(),s=Mr(t),r={...n,[s]:e};ca(r)}function ua(t){const e=Or(),n=Mr(t);return Array.isArray(e[n])&&e[n].some(pa)?void 0:e[n]}function pa(t){return t===null}function dn(t,e,n){const{maxWidth:s,minWidth:r}=t,i=s==null?100:s/n*100,a=r/n*100;return Math.min(i,Math.max(a,e))}function ha(t,e,n,s,r,i){const{panels:a,widths:o}=r,{widths:l}=i,d=l||o,p=[...d];{const x=t<0?s:n,b=a.findIndex(_=>_.id===x.id),g=d[b],y=dn(x,g+Math.abs(t),e);if(g===y)return d;t=t<0?g-y:y-g}let u=0,f=t<0?n:s,h=a.findIndex(x=>x.id===f.id);for(;;){const x=a[h],b=d[h],g=Math.abs(t)-Math.abs(u),y=dn(x,b-g,e);if(b!==y&&(u+=b-y,p[h]=y,u.toPrecision(10).localeCompare(Math.abs(t).toPrecision(10),void 0,{numeric:!0})>=0))break;if(t<0){if(--h<0)break}else if(++h>=a.length)break}return u===0?d:(f=t<0?s:n,h=a.findIndex(x=>x.id===f.id),p[h]=d[h]+u,p)}function fa(t,e,n){if(t.length===1)return"100";const s=t.findIndex(i=>i.id===e),r=n[s];return r==null?"0":r.toPrecision(10)}function Xn(t,e,n=0,s=null){const r=t.clientX,i=(s||e.getBoundingClientRect()).left;return r-i-n}function Zt(t){return t.type==="panel"}function Jn(t){return t.type==="resizer"}function Qn(t){return Array.from(t.values()).sort(({order:e},{order:n})=>e==null&&n==null?0:e==null?-1:n==null?1:e-n)}function Yn(t,e,n){const s=e.reduce((a,o)=>a+o,0),r=[...e].map(a=>a/s*100);let i=0;for(let a=0;a<t.length;a++){const o=t[a],l=r[a],d=dn(o,l,n);l!=d&&(i+=l-d,r[a]=d)}if(i.toFixed(3)!=="0.000")for(let a=0;a<t.length;a++){const o=t[a];let{maxWidth:l,minWidth:d}=o;d=d/n*100,l!=null&&(l=l/n*100);const p=Math.min(l??100,Math.max(d,r[a]+i));if(p!==r[a]&&(i-=p-r[a],r[a]=p,Math.abs(i).toFixed(3)==="0.000"))break}return r}function ma(t){let e=t.length,n=100;const s=t.map(i=>i.defaultSize?(n=n-i.defaultSize,e=e-1,i.defaultSize):null),r=n/e;return s.map(i=>i===null?r:i)}const ga=pe.div`
  display: flex;
  flex-direction: row;
  height: 100%;
  overflow: hidden;
  width: 100%;
`,va=function(t){const e=L(46),{children:n}=t,s=m.useRef(null);let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=new Map,e[0]=r):r=e[0];const[i,a]=m.useState(r);let o,l;e[1]!==i?(l=Qn(i).filter(Zt),e[1]=i,e[2]=l):l=e[2],o=l;const d=o;let p;e[3]===Symbol.for("react.memo_cache_sentinel")?(p=[],e[3]=p):p=e[3];const[u,f]=m.useState(p),[h,x]=m.useState(null);let b;e[4]!==i||e[5]!==d||e[6]!==u?(b={elements:i,panels:d,widths:u},e[4]=i,e[5]=d,e[6]=u,e[7]=b):b=e[7];const g=m.useRef(b);let y;e[8]!==h||e[9]!==d||e[10]!==u?(y=N=>({flexGrow:fa(d,N,u),pointerEvents:h===null?void 0:"none"}),e[8]=h,e[9]=d,e[10]=u,e[11]=y):y=e[11];const _=y;let S;e[12]===Symbol.for("react.memo_cache_sentinel")?(S=(N,V)=>{a(F=>{if(F.has(N))return F;const X=new Map(F);return X.set(N,V),X})},e[12]=S):S=e[12];const w=S;let j;e[13]===Symbol.for("react.memo_cache_sentinel")?(j=N=>{a(V=>{if(!V.has(N))return V;const F=new Map(V);return F.delete(N),F})},e[13]=j):j=e[13];const E=j;let T;e[14]===Symbol.for("react.memo_cache_sentinel")?(T={containerWidth:window.innerWidth,dragOffset:0,panelAfter:null,panelBefore:null,resizerIndex:-1,resizerRect:null,startX:0,widths:[]},e[14]=T):T=e[14];const R=m.useRef(T);let v;e[15]!==i?(v=(N,V)=>{const F=Qn(i),X=F.findIndex(Y=>Y.id===N),K=i.get(N);if(!K||!Jn(K))return;const ae=K.el.current;ae&&(R.current={resizerIndex:X,panelBefore:F.reduce((Y,Q,se)=>Zt(Q)&&se<X?Q:Y,null),panelAfter:F.reduce((Y,Q,se)=>Y===null&&Zt(Q)&&se>X?Q:Y,null),containerWidth:window.innerWidth,startX:V.pageX,dragOffset:Xn(V,ae),resizerRect:ae.getBoundingClientRect(),widths:g.current.widths},x(N))},e[15]=i,e[16]=v):v=e[16];const P=v;let k;e[17]===Symbol.for("react.memo_cache_sentinel")?(k=()=>{x(null)},e[17]=k):k=e[17];const C=k;let $;e[18]!==i?($=(N,V)=>{V.preventDefault(),V.stopPropagation();const{containerWidth:F,dragOffset:X,panelBefore:K,panelAfter:ae,resizerRect:Y}=R.current;if(K==null||ae==null)return;const Q=i.get(N);if(!Q||!Jn(Q))return;const se=Q.el.current;if(!se)return;const de=Xn(V,se,X,Y);if(de===0)return;const{widths:me}=g.current,ge=s.current.getBoundingClientRect(),ue=de/ge.width*100,ve=ha(ue,F,K,ae,g.current,R.current);me.some((ye,Re)=>ye!==ve[Re])&&f(ve)},e[18]=i,e[19]=$):$=e[19];const I=$;let A,D;e[20]!==i||e[21]!==d||e[22]!==u?(A=()=>{g.current.elements=i,g.current.panels=d,g.current.widths=u},D=[i,d,u],e[20]=i,e[21]=d,e[22]=u,e[23]=A,e[24]=D):(A=e[23],D=e[24]),m.useLayoutEffect(A,D);const M=la();let q,G;e[25]!==d||e[26]!==M?(q=()=>{const{widths:N}=g.current;if(N.length===d.length)return;const V=M.get(d);if(V){const X=Yn(d,V,window.innerWidth);f(X);return}const F=ma(d);f(F)},G=[M,d],e[25]=d,e[26]=M,e[27]=q,e[28]=G):(q=e[27],G=e[28]),m.useLayoutEffect(q,G);let H,B;e[29]!==d||e[30]!==M||e[31]!==u?(H=()=>{u.length&&M.setDebounced(d,u)},B=[M,d,u],e[29]=d,e[30]=M,e[31]=u,e[32]=H,e[33]=B):(H=e[32],B=e[33]),m.useEffect(H,B);let re,he;e[34]===Symbol.for("react.memo_cache_sentinel")?(re=()=>{const N=new ResizeObserver(()=>{const{panels:V,widths:F}=g.current,X=Yn(V,F,window.innerWidth);F.some((K,ae)=>K!==X[ae])&&f(X)});return N.observe(s.current),()=>{N.disconnect()}},he=[],e[34]=re,e[35]=he):(re=e[34],he=e[35]),m.useLayoutEffect(re,he);let ie,ce;e[36]!==h||e[37]!==I||e[38]!==_||e[39]!==P?(ce={activeResizer:h,drag:I,getPanelStyle:_,registerElement:w,startDragging:P,stopDragging:C,unregisterElement:E},e[36]=h,e[37]=I,e[38]=_,e[39]=P,e[40]=ce):ce=e[40],ie=ce;const le=ie;let ne;e[41]!==n?(ne=c.jsx(ga,{ref:s,children:n}),e[41]=n,e[42]=ne):ne=e[42];let fe;return e[43]!==le||e[44]!==ne?(fe=c.jsx(Nt.Provider,{value:le,children:ne}),e[43]=le,e[44]=ne,e[45]=fe):fe=e[45],fe};function $n(t){const e=L(37);let n,s,r,i,a;e[0]!==t?({children:n,message:s,onRetry:i,onContinueAnyway:r,...a}=t,e[0]=t,e[1]=n,e[2]=s,e[3]=r,e[4]=i,e[5]=a):(n=e[1],s=e[2],r=e[3],i=e[4],a=e[5]);const{t:o}=xe(we);let l;e[6]!==o?(l=o("error-card.retry-button.text"),e[6]=o,e[7]=l):l=e[7];let d;e[8]!==i||e[9]!==l?(d=c.jsx(be,{fontSize:1,mode:"ghost",onClick:i,text:l}),e[8]=i,e[9]=l,e[10]=d):d=e[10];const p=d;let u;e[11]!==o?(u=o("error-card.continue-button.text"),e[11]=o,e[12]=u):u=e[12];let f;e[13]!==r||e[14]!==u?(f=c.jsx(be,{fontSize:1,mode:"ghost",tone:"critical",onClick:r,text:u}),e[13]=r,e[14]=u,e[15]=f):f=e[15];const h=f;let x;e[16]!==o?(x=o("error-card.title"),e[16]=o,e[17]=x):x=e[17];let b;e[18]!==x?(b=c.jsx(W,{size:1,weight:"semibold",children:x}),e[18]=x,e[19]=b):b=e[19];let g;e[20]!==s?(g=c.jsx(W,{muted:!0,size:1,children:s}),e[20]=s,e[21]=g):g=e[21];let y;e[22]!==b||e[23]!==g?(y=c.jsxs(je,{space:3,children:[b,g]}),e[22]=b,e[23]=g,e[24]=y):y=e[24];let _;e[25]!==h||e[26]!==r||e[27]!==i||e[28]!==p?(_=i&&r?c.jsxs(ls,{space:2,children:[p,h]}):i?c.jsx(te,{children:p}):r?c.jsx(te,{children:h}):null,e[25]=h,e[26]=r,e[27]=i,e[28]=p,e[29]=_):_=e[29];let S;e[30]!==n||e[31]!==y||e[32]!==_?(S=c.jsx(J,{align:"center",height:"fill",justify:"center",children:c.jsx(ds,{padding:4,sizing:"border",width:0,children:c.jsxs(je,{space:4,children:[y,n,_]})})}),e[30]=n,e[31]=y,e[32]=_,e[33]=S):S=e[33];let w;return e[34]!==a||e[35]!==S?(w=c.jsx(oe,{height:"fill",...a,children:S}),e[34]=a,e[35]=S,e[36]=w):w=e[36],w}function ya(t={}){const e=Object.entries(t).map(([n,s])=>`${n}=${s}`).join("&");return e.length?`?${e}`:""}function ba(t){const e=["comment","inspect","instruction","pathKey","rev","since","template","view"],n=Object.entries(t).filter(([s])=>e.includes(s)).reduce((s,[r,i])=>i==null?s:{...s,[r]:i},{});return ya(n)}const xa=m.forwardRef(function(t,e){const n=L(11);let s,r;n[0]!==t?({searchParams:r,...s}=t,n[0]=t,n[1]=s,n[2]=r):(s=n[1],r=n[2]);let i;n[3]!==r?(i=Object.entries(r),n[3]=r,n[4]=i):i=n[4];let a;n[5]!==i?(a={type:void 0,_searchParams:i},n[5]=i,n[6]=a):a=n[6];let o;return n[7]!==e||n[8]!==s||n[9]!==a?(o=c.jsx(Lt,{...s,ref:e,state:a,title:void 0}),n[7]=e,n[8]=s,n[9]=a,n[10]=o):o=n[10],o}),wa=m.forwardRef(function(t,e){const n=L(15);let s,r,i,a;if(n[0]!==t){const{documentId:p,documentType:u,parentRefPath:f,template:h,searchParams:x,...b}=t;s=p,r=u,a=x,i=b,n[0]=t,n[1]=s,n[2]=r,n[3]=i,n[4]=a}else s=n[1],r=n[2],i=n[3],a=n[4];let o;n[5]!==a?(o=Object.entries(a),n[5]=a,n[6]=o):o=n[6];let l;n[7]!==s||n[8]!==r||n[9]!==o?(l={id:s,type:r,_searchParams:o},n[7]=s,n[8]=r,n[9]=o,n[10]=l):l=n[10];let d;return n[11]!==e||n[12]!==i||n[13]!==l?(d=c.jsx(Lt,{...i,ref:e,state:l,title:void 0}),n[11]=e,n[12]=i,n[13]=l,n[14]=d):d=n[14],d});function zr(t){const e=L(26),{children:n,onStructureParams:s,structureParams:r,searchParams:i,refs:a}=t,{state:o,resolvePathFromState:l}=vn();let d;e[0]!==o._searchParams?(d=Object.fromEntries(o._searchParams||[]),e[0]=o._searchParams,e[1]=d):d=e[1];const p=gr(d);let u;e[2]!==l||e[3]!==p||e[4]!==o?(u=R=>{const v=l(o),P=ba({...p,...R});return`${v}${P}`},e[2]=l,e[3]=p,e[4]=o,e[5]=u):u=e[5];const f=u;let h,x;e[6]===Symbol.for("react.memo_cache_sentinel")?(x={},e[6]=x):x=e[6];const b=r;let g;e[7]===Symbol.for("react.memo_cache_sentinel")?(g=[],e[7]=g):g=e[7];let y;e[8]!==a||e[9]!==i?(y=R=>{const{childId:v,...P}=R,k=a==null?void 0:a.find(C=>C._id===v||yn(C._id)===v);return k?c.jsx(Lt,{...P,state:{id:v,type:k._type,_searchParams:Object.entries(i)}}):c.jsx("div",{...P})},e[8]=a,e[9]=i,e[10]=y):y=e[10];let _,S;e[11]!==i?(_=R=>c.jsx(xa,{...R,searchParams:i}),S=R=>c.jsx(wa,{...R,searchParams:i}),e[11]=i,e[12]=_,e[13]=S):(_=e[12],S=e[13]);let w;e[14]!==s?(w=R=>{s({...R,inspect:R.inspect??void 0})},e[14]=s,e[15]=w):w=e[15];let j;e[16]!==f||e[17]!==b||e[18]!==y||e[19]!==_||e[20]!==S||e[21]!==w?(j={index:0,groupIndex:0,siblingIndex:0,payload:x,params:b,hasGroupSiblings:!1,groupLength:1,routerPanesState:g,ChildLink:y,BackLink:_,ReferenceChildLink:S,ParameterizedLink:Ia,closeCurrentAndAfter:Ca,handleEditReference:Ta,replaceCurrent:Ra,closeCurrent:Ea,duplicateCurrent:ja,setView:Pa,setParams:w,setPayload:Sa,navigateIntent:_a,createPathWithParams:f},e[16]=f,e[17]=b,e[18]=y,e[19]=_,e[20]=S,e[21]=w,e[22]=j):j=e[22],h=j;const E=h;let T;return e[23]!==n||e[24]!==E?(T=c.jsx(Js.Provider,{value:E,children:n}),e[23]=n,e[24]=E,e[25]=T):T=e[25],T}function _a(t,e,n){console.warn("navigateIntent",t,e,n)}function Sa(t){console.warn("setPayload",t)}function Pa(t){console.warn("setView",t)}function ja(t){console.warn("duplicateCurrent",t)}function Ea(){console.warn("closeCurrent")}function Ra(t){console.warn("replaceCurrent",t)}function Ta(t){console.warn("handleEditReference",t)}function Ca(){console.warn("closeCurrentAndAfter")}function Ia(){return c.jsx(c.Fragment,{children:"ParameterizedLink"})}const ka=pe(mr)`
  height: 100%;
`,Aa=pe(J)`
  & > div {
    min-width: none !important;
    max-width: none !important;
  }
`,$a=pe($t)`
  white-space: pre-wrap;
`;function Oa(t){var v,P,k,C;const e=L(33),{mainDocumentState:n,onStructureParams:s,searchParams:r,refs:i}=t,{t:a}=xe(we),{devMode:o}=mn();let l,d;if(e[0]!==((v=n==null?void 0:n.document)==null?void 0:v._id)||e[1]!==i){let $;e[3]!==((P=n==null?void 0:n.document)==null?void 0:P._id)?($=I=>{var A;return yn(I._id)!==((A=n==null?void 0:n.document)==null?void 0:A._id)},e[3]=(k=n==null?void 0:n.document)==null?void 0:k._id,e[4]=$):$=e[4],d=i.filter($).map(za),e[0]=(C=n==null?void 0:n.document)==null?void 0:C._id,e[1]=i,e[2]=d}else d=e[2];l=d;const p=l;let u,f;e[5]!==p?(f={filter:"_id in $ids",params:{ids:p}},e[5]=p,e[6]=f):f=e[6];let h;e[7]!==a?(h=a("document-list-pane.document-list.title"),e[7]=a,e[8]=h):h=e[8];let x;e[9]!==f||e[10]!==h?(x={id:"$root",options:f,schemaTypeName:"",title:h,type:"documentList"},e[9]=f,e[10]=h,e[11]=x):x=e[11],u=x;const b=u,[g,y]=m.useState(null);let _;e[12]===Symbol.for("react.memo_cache_sentinel")?(_=()=>y(null),e[12]=_):_=e[12];const S=_,[w]=m.useState(Ma);let j;e[13]===Symbol.for("react.memo_cache_sentinel")?(j=()=>y(null),e[13]=j):j=e[13];let E;if(e[14]!==i?(E=[i],e[14]=i,e[15]=E):E=e[15],m.useEffect(j,E),g){let $;e[16]!==a?($=a("document-list-pane.error.text"),e[16]=a,e[17]=$):$=e[17];let I;e[18]!==o||e[19]!==g||e[20]!==a?(I=o&&c.jsx(oe,{overflow:"auto",padding:3,radius:2,tone:"critical",children:c.jsxs(je,{space:3,children:[c.jsx(At,{muted:!0,size:0,children:a("presentation-error.label")}),c.jsx($a,{size:1,children:g.error.message})]})}),e[18]=o,e[19]=g,e[20]=a,e[21]=I):I=e[21];let A;return e[22]!==I||e[23]!==$?(A=c.jsx($n,{flex:1,message:$,onRetry:S,children:I}),e[22]=I,e[23]=$,e[24]=A):A=e[24],A}let T;e[25]!==b?(T=c.jsx(Aa,{direction:"column",flex:1,children:c.jsx(Hs,{index:0,itemId:"$root",pane:b,paneKey:"$root"})}),e[25]=b,e[26]=T):T=e[26];let R;return e[27]!==s||e[28]!==i||e[29]!==r||e[30]!==w||e[31]!==T?(R=c.jsx(br,{onCatch:y,children:c.jsx(ka,{children:c.jsx(xr,{children:c.jsx(zr,{onStructureParams:s,structureParams:w,searchParams:r,refs:i,children:T})})})}),e[27]=s,e[28]=i,e[29]=r,e[30]=w,e[31]=T,e[32]=R):R=e[32],R}function Ma(){return{}}function za(t){return t._id}const La=pe($t)`
  white-space: pre-wrap;
`;function Da(t){const e=L(35),{documentId:n,documentType:s,onFocusPath:r,onStructureParams:i,searchParams:a,structureParams:o}=t,{template:l,templateParams:d}=o,{t:p}=xe(we),{devMode:u}=mn();let f,h;e[0]!==d?(h=Qs(d),e[0]=d,e[1]=h):h=e[1];let x;e[2]!==n||e[3]!==s||e[4]!==h||e[5]!==l?(x={id:n,type:s,template:l,templateParameters:h},e[2]=n,e[3]=s,e[4]=h,e[5]=l,e[6]=x):x=e[6];let b;e[7]!==n||e[8]!==x?(b={id:n,options:x,title:"",type:"document"},e[7]=n,e[8]=x,e[9]=b):b=e[9],f=b;const g=f,[y,_]=m.useState(null);let S;e[10]===Symbol.for("react.memo_cache_sentinel")?(S=()=>_(null),e[10]=S):S=e[10];const w=S;let j;e[11]===Symbol.for("react.memo_cache_sentinel")?(j=()=>{_(null)},e[11]=j):j=e[11];let E;if(e[12]!==n||e[13]!==s||e[14]!==o?(E=[n,s,o],e[12]=n,e[13]=s,e[14]=o,e[15]=E):E=e[15],m.useEffect(j,E),y){let k;e[16]!==p?(k=p("document-pane.error.text"),e[16]=p,e[17]=k):k=e[17];let C;e[18]!==u||e[19]!==y||e[20]!==p?(C=u&&c.jsx(oe,{overflow:"auto",padding:3,radius:2,tone:"critical",children:c.jsxs(je,{space:3,children:[c.jsx(At,{muted:!0,size:0,children:p("presentation-error.label")}),c.jsx(La,{size:1,children:y.error.message})]})}),e[18]=u,e[19]=y,e[20]=p,e[21]=C):C=e[21];let $;return e[22]!==k||e[23]!==C?($=c.jsx($n,{flex:1,message:k,onRetry:w,children:C}),e[22]=k,e[23]=C,e[24]=$):$=e[24],$}let T;e[25]===Symbol.for("react.memo_cache_sentinel")?(T={height:"100%"},e[25]=T):T=e[25];let R;e[26]===Symbol.for("react.memo_cache_sentinel")?(R=c.jsx(vr,{}),e[26]=R):R=e[26];let v;e[27]!==r||e[28]!==g?(v=c.jsx(m.Suspense,{fallback:R,children:c.jsx(Ys,{paneKey:"document",index:1,itemId:"document",pane:g,onFocusPath:r})}),e[27]=r,e[28]=g,e[29]=v):v=e[29];let P;return e[30]!==i||e[31]!==a||e[32]!==o||e[33]!==v?(P=c.jsx(br,{onCatch:_,children:c.jsx(mr,{style:T,children:c.jsx(zr,{searchParams:a,onStructureParams:i,structureParams:o,children:v})})}),e[30]=i,e[31]=a,e[32]=o,e[33]=v,e[34]=P):P=e[34],P}function Ua(t){const e=L(7),{documentId:n,documentType:s,onFocusPath:r,onStructureParams:i,searchParams:a,structureParams:o}=t;let l;return e[0]!==n||e[1]!==s||e[2]!==r||e[3]!==i||e[4]!==a||e[5]!==o?(l=c.jsx(xr,{children:c.jsx(Da,{documentId:n,documentType:s,onFocusPath:r,onStructureParams:i,searchParams:a,structureParams:o})}),e[0]=n,e[1]=s,e[2]=r,e[3]=i,e[4]=a,e[5]=o,e[6]=l):l=e[6],l}function Wa(t,e){const n=L(6),s=Ls();let r;n[0]===Symbol.for("react.memo_cache_sentinel")?(r={},n[0]=r):r=n[0];const[i,a]=m.useState(r);let o,l;return n[1]!==t||n[2]!==s||n[3]!==e?(o=()=>{if(!e)return;const d=Ks(s,e,t,"").subscribe(p=>{a(p)});return()=>{d==null||d.unsubscribe()}},l=[s,e,t],n[1]=t,n[2]=s,n[3]=e,n[4]=o,n[5]=l):(o=n[4],l=n[5]),m.useEffect(o,l),i}function Na(t){var T,R,v,P,k,C,$,I;const e=L(39),{documentId:n,documentType:s,mainDocumentState:r,onFocusPath:i,onStructureParams:a,refs:o,searchParams:l,structureParams:d}=t,{t:p}=xe(we),u=Cs();let f;e[0]!==((T=r==null?void 0:r.document)==null?void 0:T._id)||e[1]!==((R=r==null?void 0:r.document)==null?void 0:R._type)||e[2]!==l?(f=A=>{var D,M;return c.jsx(Lt,{...A,state:{id:(D=r==null?void 0:r.document)==null?void 0:D._id,type:(M=r==null?void 0:r.document)==null?void 0:M._type,_searchParams:Object.entries(l)}})},e[0]=(v=r==null?void 0:r.document)==null?void 0:v._id,e[1]=(P=r==null?void 0:r.document)==null?void 0:P._type,e[2]=l,e[3]=f):f=e[3];const h=f;let x,b;e[4]!==((k=r==null?void 0:r.document)==null?void 0:k._type)||e[5]!==u?(b=u.get(((C=r==null?void 0:r.document)==null?void 0:C._type)||"shoe"),e[4]=($=r==null?void 0:r.document)==null?void 0:$._type,e[5]=u,e[6]=b):b=e[6],x=b;const g=x,y=Wa(((I=r==null?void 0:r.document)==null?void 0:I._id)||"",g);let _;e:{if(!(r!=null&&r.document)){_=null;break e}const A=r.document;let D;e[7]!==y.draft||e[8]!==y.published||e[9]!==A?(D=Is({value:A,published:y.published,draft:y.draft}),e[7]=y.draft,e[8]=y.published,e[9]=A,e[10]=D):D=e[10];let M;e[11]!==p?(M=p("main-document.label"),e[11]=p,e[12]=M):M=e[12];let q;e[13]!==M?(q=c.jsx(oe,{padding:1,radius:2,shadow:1,children:c.jsx(W,{muted:!0,size:0,weight:"medium",children:M})}),e[13]=M,e[14]=q):q=e[14];let G;e[15]!==g||e[16]!==D||e[17]!==q?(G=c.jsx(ks,{...D,schemaType:g,status:q}),e[15]=g,e[16]=D,e[17]=q,e[18]=G):G=e[18],_=G}const S=_;if(n&&s){let A;return e[19]!==n||e[20]!==s||e[21]!==i||e[22]!==a||e[23]!==l||e[24]!==d?(A=c.jsx(Ua,{documentId:n,documentType:s,onFocusPath:i,onStructureParams:a,searchParams:l,structureParams:d}),e[19]=n,e[20]=s,e[21]=i,e[22]=a,e[23]=l,e[24]=d,e[25]=A):A=e[25],A}let w;e[26]!==h||e[27]!==r||e[28]!==S||e[29]!==p?(w=r&&c.jsx(oe,{padding:3,tone:r.document?"inherit":"caution",children:r.document?c.jsx(As,{__unstable_focusRing:!0,as:h,"data-as":"a",radius:2,sizing:"border",tone:"inherit",children:S}):c.jsx(oe,{padding:2,radius:2,tone:"inherit",children:c.jsxs(J,{gap:3,children:[c.jsx(te,{flex:"none",children:c.jsx(W,{size:1,children:c.jsx($s,{})})}),c.jsx(te,{flex:1,children:c.jsx(W,{size:1,children:c.jsx(Os,{t:p,i18nKey:"main-document.missing.text",components:{Code:"code"},values:{path:r.path}})})})]})})}),e[26]=h,e[27]=r,e[28]=S,e[29]=p,e[30]=w):w=e[30];let j;e[31]!==r||e[32]!==a||e[33]!==o||e[34]!==l?(j=c.jsx(Oa,{mainDocumentState:r,onStructureParams:a,searchParams:l,refs:o}),e[31]=r,e[32]=a,e[33]=o,e[34]=l,e[35]=j):j=e[35];let E;return e[36]!==w||e[37]!==j?(E=c.jsxs(J,{direction:"column",flex:1,height:"fill",children:[w,j]}),e[36]=w,e[37]=j,e[38]=E):E=e[38],E}var ee=[];for(var en=0;en<256;++en)ee.push((en+256).toString(16).slice(1));function qa(t,e=0){return(ee[t[e+0]]+ee[t[e+1]]+ee[t[e+2]]+ee[t[e+3]]+"-"+ee[t[e+4]]+ee[t[e+5]]+"-"+ee[t[e+6]]+ee[t[e+7]]+"-"+ee[t[e+8]]+ee[t[e+9]]+"-"+ee[t[e+10]]+ee[t[e+11]]+ee[t[e+12]]+ee[t[e+13]]+ee[t[e+14]]+ee[t[e+15]]).toLowerCase()}var Ct,Fa=new Uint8Array(16);function Va(){if(!Ct&&(Ct=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Ct))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ct(Fa)}var Ka=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Zn={randomUUID:Ka};function Ha(t,e,n){if(Zn.randomUUID&&!e&&!t)return Zn.randomUUID();t=t||{};var s=t.random||(t.rng||Va)();return s[6]=s[6]&15|64,s[8]=s[8]&63|128,qa(s)}function Ba(t){const e=L(2);let n;e[0]!==t?(n=()=>t||Ha(),e[0]=t,e[1]=n):n=e[1];const[s]=m.useState(n);return s}const Ga=pe.div`
  position: relative;
`,Xa=pe.div`
  position: absolute;
  top: 0;
  bottom: 0;
  left: -5px;
  width: 9px;
  z-index: 10;
  cursor: ${({$disabled:t})=>t?"auto":"ew-resize"};

  /* Border */
  & > span:nth-child(1) {
    display: block;
    border-left: 1px solid var(--card-border-color);
    position: absolute;
    top: 0;
    left: 4px;
    bottom: 0;
    transition: opacity 200ms;
  }

  ${({$disabled:t})=>!t&&`
    /* Hover effect */
    & > span:nth-child(2) {
      display: block;
      position: absolute;
      top: 0;
      left: 0;
      width: 9px;
      bottom: 0;
      background-color: var(--card-border-color);
      opacity: 0;
      transition: opacity 150ms;
    }

    @media (hover: hover) {
      &:hover > span:nth-child(2) {
        opacity: 0.2;
      }
    }
  `}
`,Lr=function(t){const e=L(27),{id:n,order:s,disabled:r}=t,i=r===void 0?!1:r,a=m.useRef(null),o=m.useContext(Nt);if(o===null)throw Error("Panel components must be rendered within a PanelGroup container");const l=Ba(n),{activeResizer:d,drag:p,startDragging:u,stopDragging:f,registerElement:h,unregisterElement:x}=o,b=d===l;if(o===null)throw Error("Panel components must be rendered within a PanelGroup container");let g;e[0]!==l||e[1]!==u?(g=I=>{u(l,I.nativeEvent)},e[0]=l,e[1]=u,e[2]=g):g=e[2];const y=g;let _;e[3]!==p||e[4]!==l?(_=I=>{p(l,I)},e[3]=p,e[4]=l,e[5]=_):_=e[5];const S=_;let w;e[6]!==f?(w=()=>{a.current.blur(),f()},e[6]=f,e[7]=w):w=e[7];const j=w;let E,T;e[8]!==i||e[9]!==b||e[10]!==S||e[11]!==j?(E=()=>{if(!b||i)return;const I=function(){const A=document.body.style,D=document.documentElement.style,{cursor:M}=D,{userSelect:q}=A;return D.cursor="ew-resize",A.userSelect="none",()=>{M?D.cursor=M:D.removeProperty("cursor"),q?A.userSelect=q:A.removeProperty("user-select")}}();return window.addEventListener("mousemove",S),window.addEventListener("mouseup",j),window.addEventListener("contextmenu",j),()=>{I(),window.removeEventListener("mousemove",S),window.removeEventListener("mouseup",j),window.removeEventListener("contextmenu",j)}},T=[i,b,S,j],e[8]=i,e[9]=b,e[10]=S,e[11]=j,e[12]=E,e[13]=T):(E=e[12],T=e[13]),m.useEffect(E,T);let R,v;e[14]!==l||e[15]!==s||e[16]!==h||e[17]!==x?(R=()=>(h(l,{id:l,order:s,type:"resizer",el:a}),()=>{x(l)}),v=[l,s,h,x],e[14]=l,e[15]=s,e[16]=h,e[17]=x,e[18]=R,e[19]=v):(R=e[18],v=e[19]),m.useLayoutEffect(R,v);let P,k;e[20]===Symbol.for("react.memo_cache_sentinel")?(k=c.jsx("span",{}),P=c.jsx("span",{}),e[20]=P,e[21]=k):(P=e[20],k=e[21]);let C;e[22]!==i?(C=c.jsxs(Xa,{$disabled:i,children:[k,P]}),e[22]=i,e[23]=C):C=e[23];let $;return e[24]!==y||e[25]!==C?($=c.jsx(Ga,{onMouseDown:y,ref:a,children:C}),e[24]=y,e[25]=C,e[26]=$):$=e[26],$},Ja=t=>{const e=L(8),{documentId:n,setDisplayedDocument:s,getCommentIntent:r}=t;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=c.jsx(Lr,{order:4}),e[0]=i):i=e[0];let a;e[1]!==r||e[2]!==t.children?(a=c.jsx(Ms,{getIntent:r,children:t.children}),e[1]=r,e[2]=t.children,e[3]=a):a=e[3];let o;return e[4]!==n||e[5]!==s||e[6]!==a?(o=c.jsxs(c.Fragment,{children:[i,c.jsx(An,{id:"content",minWidth:325,order:5,children:c.jsx(ei,{documentId:n,setDisplayedDocument:s,children:a})})]}),e[4]=n,e[5]=s,e[6]=a,e[7]=o):o=e[7],o},Qa=t=>{const e=L(14),{documentId:n,documentsOnPage:s,documentType:r,getCommentIntent:i,mainDocumentState:a,onFocusPath:o,onStructureParams:l,searchParams:d,setDisplayedDocument:p,structureParams:u}=t;let f;e[0]!==n||e[1]!==r||e[2]!==s||e[3]!==a||e[4]!==o||e[5]!==l||e[6]!==d||e[7]!==u?(f=c.jsx(Na,{documentId:n,documentType:r,mainDocumentState:a,onFocusPath:o,onStructureParams:l,refs:s,searchParams:d,structureParams:u}),e[0]=n,e[1]=r,e[2]=s,e[3]=a,e[4]=o,e[5]=l,e[6]=d,e[7]=u,e[8]=f):f=e[8];let h;return e[9]!==n||e[10]!==i||e[11]!==p||e[12]!==f?(h=c.jsx(Ja,{documentId:n,getCommentIntent:i,setDisplayedDocument:p,children:f}),e[9]=n,e[10]=i,e[11]=p,e[12]=f,e[13]=h):h=e[13],h},Ya=function(t){const e=L(5),{children:n,navigate:s}=t;let r;e[0]!==s?(r=(o,l)=>{s((l===void 0?void 0:l)||{},o?{preview:o}:{})},e[0]=s,e[1]=r):r=e[1];const i=r;let a;return e[2]!==n||e[3]!==i?(a=c.jsx(Ss.Provider,{value:i,children:n}),e[2]=n,e[3]=i,e[4]=a):a=e[4],a};function Za(t,e){const n=L(9);let s;n[0]!==e||n[1]!==t?(s=()=>JSON.parse(localStorage.getItem(t)??JSON.stringify(e)),n[0]=e,n[1]=t,n[2]=s):s=n[2];const[r,i]=m.useState(s);let a,o;n[3]!==t||n[4]!==r?(a=()=>{localStorage.setItem(t,JSON.stringify(r))},o=[t,r],n[3]=t,n[4]=r,n[5]=a,n[6]=o):(a=n[5],o=n[6]),m.useEffect(a,o);let l;return n[7]!==r?(l=[r,i],n[7]=r,n[8]=l):l=n[8],l}function eo(t){const e=L(11),{unstable_navigator:n}=t,s=!!(n!=null&&n.component),[r,i]=Za("presentation/navigator",s),a=s?r:!1;let o;e:{if(!s){o=void 0;break e}let h;e[0]!==i?(h=()=>i(to),e[0]=i,e[1]=h):h=e[1],o=h}const l=o;let d;e[2]!==a||e[3]!==n?(d=function(){return c.jsx(c.Fragment,{children:a&&c.jsx(ro,{...n})})},e[2]=a,e[3]=n,e[4]=d):d=e[4];const p=d;let u;e[5]!==a||e[6]!==l?(u={navigatorEnabled:a,toggleNavigator:l},e[5]=a,e[6]=l,e[7]=u):u=e[7];let f;return e[8]!==p||e[9]!==u?(f=[u,p],e[8]=p,e[9]=u,e[10]=f):f=e[10],f}function to(t){return!t}function no(t){const e=L(11),{minWidth:n,maxWidth:s,component:r}=t,i=n!=null&&s!=null&&n===s;let a;e[0]!==r?(a=c.jsx(r,{}),e[0]=r,e[1]=a):a=e[1];let o;e[2]!==s||e[3]!==n||e[4]!==a?(o=c.jsx(An,{id:"navigator",minWidth:n,maxWidth:s,order:1,children:a}),e[2]=s,e[3]=n,e[4]=a,e[5]=o):o=e[5];let l;e[6]!==i?(l=c.jsx(Lr,{order:2,disabled:i}),e[6]=i,e[7]=l):l=e[7];let d;return e[8]!==o||e[9]!==l?(d=c.jsxs(c.Fragment,{children:[o,l]}),e[8]=o,e[9]=l,e[10]=d):d=e[10],d}const ro=m.memo(no),so=function(t){const e=L(3),{children:n,params:s}=t;let r;r=s;const i=r;let a;return e[0]!==n||e[1]!==i?(a=c.jsx(Ps.Provider,{value:i,children:n}),e[0]=n,e[1]=i,e[2]=a):a=e[2],a},io=function(t){const e=L(10),{children:n,devMode:s,name:r,navigate:i,params:a,searchParams:o,structureParams:l}=t;let d,p;e[0]!==s||e[1]!==r||e[2]!==i||e[3]!==a||e[4]!==o||e[5]!==l?(p={devMode:s,name:r,navigate:i,params:a,searchParams:o,structureParams:l},e[0]=s,e[1]=r,e[2]=i,e[3]=a,e[4]=o,e[5]=l,e[6]=p):p=e[6],d=p;const u=d;let f;return e[7]!==n||e[8]!==u?(f=c.jsx(js.Provider,{value:u,children:n}),e[7]=n,e[8]=u,e[9]=f):f=e[9],f},ao=bt(pe.iframe`
  box-shadow: 0 0 0 1px var(--card-border-color);
  border-top: 1px solid transparent;
  border-bottom: 0;
  border-right: 0;
  border-left: 0;
  max-height: 100%;
  width: 100%;
`),oo=pe(te)`
  position: absolute;
  inset: 0;
  background: transparent;
`,co=m.forwardRef(function(t,e){const n=L(12),{animate:s,initial:r,onLoad:i,preventClick:a,src:o,variants:l}=t;let d;n[0]!==s||n[1]!==r||n[2]!==i||n[3]!==e||n[4]!==o||n[5]!==l?(d=c.jsx(ao,{animate:s,initial:r,onLoad:i,ref:e,src:o,variants:l}),n[0]=s,n[1]=r,n[2]=i,n[3]=e,n[4]=o,n[5]=l,n[6]=d):d=n[6];let p;n[7]!==a?(p=a&&c.jsx(oo,{}),n[7]=a,n[8]=p):p=n[8];let u;return n[9]!==d||n[10]!==p?(u=c.jsxs(c.Fragment,{children:[d,p]}),n[9]=d,n[10]=p,n[11]=u):u=n[11],u});function lo(t){const e=L(16),{openPopup:n,previewLocationOrigin:s,previewLocationRoute:r}=t,{t:i}=xe(we);let a;e[0]!==n?(a=b=>{b.preventDefault(),n(b.currentTarget.href)},e[0]=n,e[1]=a):a=e[1];const o=a;let l;e[2]!==i?(l=i("share-url.menu-item.open.text"),e[2]=i,e[3]=l):l=e[3];let d;e[4]!==l?(d=c.jsx(W,{size:1,children:l}),e[4]=l,e[5]=d):d=e[5];let p;e[6]===Symbol.for("react.memo_cache_sentinel")?(p=["bottom-start"],e[6]=p):p=e[6];let u;e[7]!==i?(u=i("share-url.menu-item.open.text"),e[7]=i,e[8]=u):u=e[8];const f=`${s}${r}`;let h;e[9]!==o||e[10]!==u||e[11]!==f?(h=c.jsx(be,{as:"a","aria-label":u,fontSize:1,icon:Bs,mode:"bleed",padding:2,href:f,onClick:o,rel:"opener",target:"_blank"}),e[9]=o,e[10]=u,e[11]=f,e[12]=h):h=e[12];let x;return e[13]!==d||e[14]!==h?(x=c.jsx(dt,{animate:!0,content:d,fallbackPlacements:p,padding:2,placement:"bottom",portal:!0,children:h}),e[13]=d,e[14]=h,e[15]=x):x=e[15],x}const uo=function(t){var q;const e=L(27),{fontSize:n,onChange:s,origin:r,padding:i,prefix:a,suffix:o,value:l}=t,d=n===void 0?1:n,p=i===void 0?3:i,{t:u}=xe(we),{basePath:f}=((q=yr())==null?void 0:q.activeWorkspace)||{},h=f===void 0?"/":f,x=m.useRef(null),[b,g]=m.useState(void 0),[y,_]=m.useState(void 0);let S;e[0]===Symbol.for("react.memo_cache_sentinel")?(S=G=>{g(G.currentTarget.value)},e[0]=S):S=e[0];const w=S;let j;e[1]!==h||e[2]!==s||e[3]!==r||e[4]!==b||e[5]!==u?(j=G=>{var H;if(G.key==="Enter"){if(b===void 0)return;const B=b.startsWith("/")||b===""?`${r}${b}`:b;if(!B.startsWith(r+"/")&&B!==r){_(u("preview-location-input.error",{origin:r,context:"missing-origin"}));return}if(!r&&(B.startsWith(`${h}/`)||B===h)){_(u("preview-location-input.error",{basePath:h,context:"same-base-path"}));return}const re=B===r?r+"/":B;_(void 0),g(void 0),s(re.slice(r.length)),(H=x.current)==null||H.blur()}G.key==="Escape"&&(_(void 0),g(void 0))},e[1]=h,e[2]=s,e[3]=r,e[4]=b,e[5]=u,e[6]=j):j=e[6];const E=j;let T;e[7]===Symbol.for("react.memo_cache_sentinel")?(T=()=>{_(void 0),g(void 0)},e[7]=T):T=e[7];const R=T;let v;e[8]===Symbol.for("react.memo_cache_sentinel")?(v=()=>{_(void 0),g(void 0)},e[8]=v):v=e[8];let P;e[9]!==r||e[10]!==l?(P=[r,l],e[9]=r,e[10]=l,e[11]=P):P=e[11],m.useEffect(v,P);let k,C;e[12]===Symbol.for("react.memo_cache_sentinel")?(C={icon:Gs},e[12]=C):C=e[12],k=C;const $=y?k:void 0;let I;e[13]!==r||e[14]!==l?(I=()=>{_(void 0),g(r+l)},e[13]=r,e[14]=l,e[15]=I):I=e[15];let A;e[16]===Symbol.for("react.memo_cache_sentinel")?(A={zIndex:1},e[16]=A):A=e[16];const D=b===void 0?`${r}${l}`:b;let M;return e[17]!==y||e[18]!==d||e[19]!==E||e[20]!==p||e[21]!==a||e[22]!==o||e[23]!==$||e[24]!==I||e[25]!==D?(M=c.jsx(c.Fragment,{children:c.jsx(Xs,{clearButton:$,customValidity:y,fontSize:d,onBlur:R,onClear:I,onChange:w,onKeyDownCapture:E,padding:p,prefix:a,style:A,radius:2,ref:x,space:p,suffix:o,value:D})}),e[17]=y,e[18]=d,e[19]=E,e[20]=p,e[21]=a,e[22]=o,e[23]=$,e[24]=I,e[25]=D,e[26]=M):M=e[26],M},po=m.lazy(()=>Ee(()=>import("./QRCodeSVG-270e67f6.js"),["static/QRCodeSVG-270e67f6.js","static/sanity-3b6b2486.js"])),un=24,ho=16,fo=224,mo=pe(us)`
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  height: ${un}px;
  width: ${un}px;
`,go=bt(kt),vo=bt(W),yo=bt(mo),Dr=m.memo(function(t){const{canToggleSharePreviewAccess:e,canUseSharedPreviewAccess:n,initialUrl:s,previewLocationRoute:r,perspective:i}=t,{t:a}=xe(we),{push:o}=cr(),l=Dt({apiVersion:Ut}),d=fn(),[p,u]=m.useState(!0),[f,h]=m.useState(!1),[x,b]=m.useState(!1),[g,y]=m.useState(null),_=f||x||p,S=m.useMemo(()=>g?Ai(s,g,r,i):null,[s,i,r,g]),[w,j]=m.useState(null);if(w)throw w;const E=m.useCallback(()=>{o({closable:!0,status:"warning",title:a("share-preview-menu.error_toggle-sharing",{context:"toggle-sharing"})})},[o,a]),T=m.useCallback(async()=>{try{b(!0),await Oi(l,"@sanity/presentation",typeof window>"u"?"":location.href,d==null?void 0:d.id),y(null)}catch(P){j(P)}finally{b(!1)}},[l,d==null?void 0:d.id]),R=m.useCallback(async()=>{try{h(!0);const P=await $i(l,"@sanity/presentation",typeof window>"u"?"":location.href,d==null?void 0:d.id);y(P.secret)}catch(P){j(P)}finally{h(!1)}},[l,d==null?void 0:d.id]),v=m.useCallback(()=>{try{if(!S)throw new Error("No URL to copy");navigator.clipboard.writeText(S.toString()),o({closable:!0,status:"success",title:a("share-url.clipboard.status",{context:"success"})})}catch(P){j(P)}},[o,a,S]);return m.useEffect(()=>{let P=new AbortController,k=[];async function C(I,A){const{result:D,syncTags:M}=await l.fetch(ii,{},{filterResponse:!1,lastLiveEventId:I,tag:"presentation.fetch-shared-access-secret"});Array.isArray(M)&&(k=M),A.aborted||y(D)}const $=l.live.events().subscribe({next:I=>{I.type==="message"&&(P.abort(),P=new AbortController,I.tags.some(A=>k.includes(A))&&C(I.id,P.signal))},error:j});return C(null,P.signal).finally(()=>u(!1)),()=>{$.unsubscribe(),P.abort()}},[l]),c.jsx(lr,{button:c.jsx(be,{"aria-label":a("preview-frame.share-button.aria-label"),fontSize:1,icon:Zr,mode:"bleed",padding:2}),id:"share-menu",menu:c.jsx(dr,{style:{maxWidth:248},padding:n?void 0:0,children:n?c.jsxs(c.Fragment,{children:[c.jsx("label",{style:{cursor:"pointer"},children:c.jsxs(es,{columns:2,rows:2,gapX:3,gapY:1,style:{justifyContent:"center",alignItems:"center",gridTemplateColumns:"min-content 1fr",gridTemplateRows:"min-content"},paddingTop:3,paddingX:3,children:[c.jsx(dt,{animate:!0,content:c.jsx(W,{size:1,children:a("share-preview-menu.toggle-button.tooltip",{context:S?"disable":"enable"})}),fallbackPlacements:["bottom-start"],padding:1,placement:"bottom",portal:!0,children:c.jsx(ur,{checked:f||S!==null&&!x,readOnly:f||x,indeterminate:p,onChange:e?S?T:R:E})}),c.jsx(W,{size:1,weight:"medium",children:a("share-preview-menu.toggle-button.label",{context:"first-line"})}),c.jsx("span",{}),c.jsx(W,{muted:!0,size:1,children:a("share-preview-menu.toggle-button.label",{context:"second-line"})})]})}),c.jsx(te,{padding:3,paddingTop:2,children:c.jsxs(je,{space:3,children:[c.jsx(oe,{tone:_||!S?"transparent":void 0,style:{position:"relative",aspectRatio:"1 / 1",display:"flex",alignItems:"center",justifyContent:"center"},children:c.jsx(pr,{children:_?c.jsx(go,{muted:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}):S?c.jsx(c.Fragment,{children:c.jsxs(m.Suspense,{fallback:c.jsx(kt,{}),children:[c.jsx(po,{title:a("share-preview-menu.qr-code.title",{url:S.toString()}),value:S.toString(),size:fo,color:"var(--card-fg-color)",logoSize:un+ho}),c.jsx(yo,{initial:{opacity:-.5},animate:{opacity:1.5},exit:{opacity:0}})]})}):c.jsx(vo,{muted:!0,size:1,style:{maxWidth:"100px",textWrap:"pretty",textAlign:"center"},initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:a("share-preview-menu.qr-code.placeholder")})})}),c.jsx(W,{muted:!0,size:1,children:a("share-preview-menu.qr-code.instructions")})]})}),c.jsx(ts,{}),c.jsx(cn,{disabled:!S||x,icon:ns,onClick:v,fontSize:1,padding:3,text:a("share-preview-menu.copy-url.text")})]}):c.jsx(oe,{padding:2,tone:"caution",radius:3,children:c.jsx(W,{style:{textWrap:"pretty"},children:a("share-preview-menu.error",{context:"missing-grants"})})})}),popover:{animate:!0,constrainSize:!0,placement:"bottom",portal:!0}})});Dr.displayName="Memo(SharePreviewMenu)";const tn={previewDrafts:"preview-frame.perspective.previewDrafts.title",published:"preview-frame.perspective.published.title"},er={previewDrafts:"caution",published:"positive"},tr={previewDrafts:Ds,published:Us},bo=t=>{const e=L(164),{canSharePreviewAccess:n,canToggleSharePreviewAccess:s,canUseSharedPreviewAccess:r,dispatch:i,iframe:a,iframeRef:o,initialUrl:l,loadersConnection:d,navigatorEnabled:p,onPathChange:u,onRefresh:f,openPopup:h,overlaysConnection:x,perspective:b,previewUrl:g,setPerspective:y,setViewport:_,targetOrigin:S,toggleNavigator:w,toggleOverlay:j,viewport:E,visualEditing:T}=t,{overlaysEnabled:R}=T,{t:v}=xe(we);let P;e[0]!==_||e[1]!==E?(P=()=>_(E==="desktop"?"mobile":"desktop"),e[0]=_,e[1]=E,e[2]=P):P=e[2];const k=P;let C;C=S===location.origin?"":S;const $=C;let I;e[3]!==i||e[4]!==o.current||e[5]!==f||e[6]!==g||e[7]!==S?(I=()=>{f(()=>{o.current&&(i({type:hr}),Object.assign(o.current,{src:`${S}${g||"/"}`}))})},e[3]=i,e[4]=o.current,e[5]=f,e[6]=g,e[7]=S,e[8]=I):I=e[8];const A=I;let D;const M=new URL(g||"/",S),{pathname:q,search:G}=ki(M);D=`${q}${G}`;const H=D;let B;e[9]!==p||e[10]!==v||e[11]!==w?(B=w&&c.jsx(te,{flex:"none",marginRight:1,padding:1,children:c.jsx(dt,{animate:!0,content:c.jsx(W,{size:1,children:v("preview-frame.navigator.toggle-button.tooltip")}),fallbackPlacements:["bottom-start"],padding:2,placement:"bottom",portal:!0,children:c.jsx(be,{"aria-label":v("preview-frame.navigator.toggle-button.aria-label"),fontSize:1,icon:zs,mode:"bleed",onClick:w,padding:2,selected:p})})}),e[9]=p,e[10]=v,e[11]=w,e[12]=B):B=e[12];let re;e[13]===Symbol.for("react.memo_cache_sentinel")?(re={whiteSpace:"nowrap"},e[13]=re):re=e[13];const he=R?"disable":"enable";let ie;e[14]!==v||e[15]!==he?(ie=v("preview-frame.overlay.toggle-button.tooltip",{context:he}),e[14]=v,e[15]=he,e[16]=ie):ie=e[16];let ce;e[17]!==ie?(ce=c.jsx(te,{padding:1,children:c.jsx(W,{size:1,children:ie})}),e[17]=ie,e[18]=ce):ce=e[18];let le;e[19]===Symbol.for("react.memo_cache_sentinel")?(le=c.jsx(te,{paddingY:1,children:c.jsx(Ws,{keys:["Alt"],style:{marginTop:-4,marginBottom:-4}})}),e[19]=le):le=e[19];let ne;e[20]!==ce?(ne=c.jsxs(J,{align:"center",style:re,children:[ce,le]}),e[20]=ce,e[21]=ne):ne=e[21];let fe;e[22]===Symbol.for("react.memo_cache_sentinel")?(fe=["bottom-start"],e[22]=fe):fe=e[22];let N;e[23]===Symbol.for("react.memo_cache_sentinel")?(N={lineHeight:0,borderRadius:999,userSelect:"none"},e[23]=N):N=e[23];const V=R?"transparent":void 0;let F;e[24]===Symbol.for("react.memo_cache_sentinel")?(F={margin:-4},e[24]=F):F=e[24];const X=a.status==="loading"||x!=="connected";let K;e[25]!==R||e[26]!==X||e[27]!==j?(K=c.jsx("div",{style:F,children:c.jsx(ur,{checked:R,onChange:j,disabled:X})}),e[25]=R,e[26]=X,e[27]=j,e[28]=K):K=e[28];const ae=!R;let Y;e[29]!==v?(Y=v("preview-frame.overlay.toggle-button.text"),e[29]=v,e[30]=Y):Y=e[30];let Q;e[31]!==ae||e[32]!==Y?(Q=c.jsx(te,{children:c.jsx(W,{muted:ae,size:1,weight:"medium",children:Y})}),e[31]=ae,e[32]=Y,e[33]=Q):Q=e[33];let se;e[34]!==K||e[35]!==Q?(se=c.jsxs(J,{align:"center",gap:3,children:[K,Q]}),e[34]=K,e[35]=Q,e[36]=se):se=e[36];let de;e[37]!==V||e[38]!==se?(de=c.jsx(oe,{as:"label",flex:"none",marginRight:1,padding:3,style:N,tone:V,children:se}),e[37]=V,e[38]=se,e[39]=de):de=e[39];let me;e[40]!==ne||e[41]!==de?(me=c.jsx(dt,{animate:!0,content:ne,fallbackPlacements:fe,padding:1,placement:"bottom",portal:!0,children:de}),e[40]=ne,e[41]=de,e[42]=me):me=e[42];let ge;e[43]!==a.status||e[44]!==v?(ge=a.status==="loaded"?v("preview-frame.refresh-button.tooltip"):v("preview-frame.status",{context:a.status}),e[43]=a.status,e[44]=v,e[45]=ge):ge=e[45];let ue;e[46]!==ge?(ue=c.jsx(W,{size:1,children:ge}),e[46]=ge,e[47]=ue):ue=e[47];let ve;e[48]===Symbol.for("react.memo_cache_sentinel")?(ve=["bottom-end"],e[48]=ve):ve=e[48];let ye;e[49]!==v?(ye=v("preview-frame.refresh-button.aria-label"),e[49]=v,e[50]=ye):ye=e[50];const Re=a.status==="reloading"||a.status==="refreshing";let Te;e[51]!==A||e[52]!==ye||e[53]!==Re?(Te=c.jsx(be,{"aria-label":ye,fontSize:1,icon:Ns,mode:"bleed",loading:Re,onClick:A,padding:2}),e[51]=A,e[52]=ye,e[53]=Re,e[54]=Te):Te=e[54];let Ce;e[55]!==ue||e[56]!==Te?(Ce=c.jsx(te,{padding:1,children:c.jsx(dt,{animate:!0,content:ue,fallbackPlacements:ve,padding:2,placement:"bottom",portal:!0,children:Te})}),e[55]=ue,e[56]=Te,e[57]=Ce):Ce=e[57];let Ie;e[58]!==h||e[59]!==$||e[60]!==H?(Ie=c.jsx(te,{padding:1,children:c.jsx(lo,{openPopup:h,previewLocationOrigin:$,previewLocationRoute:H})}),e[58]=h,e[59]=$,e[60]=H,e[61]=Ie):Ie=e[61];let _e;e[62]!==u||e[63]!==$||e[64]!==H||e[65]!==Ce||e[66]!==Ie?(_e=c.jsx(te,{flex:1,marginX:1,children:c.jsx(uo,{prefix:Ce,onChange:u,origin:$,suffix:Ie,value:H})}),e[62]=u,e[63]=$,e[64]=H,e[65]=Ce,e[66]=Ie,e[67]=_e):_e=e[67];const Oe=tn[d==="connected"?b:"previewDrafts"];let Se;e[68]!==v||e[69]!==Oe?(Se=v(Oe),e[68]=v,e[69]=Oe,e[70]=Se):Se=e[70];const Me=d==="reconnecting"&&a.status!=="loaded",ze=d!=="connected";let O;e[71]!==Se||e[72]!==Me||e[73]!==ze?(O=c.jsx(be,{fontSize:1,iconRight:qs,mode:"bleed",padding:2,space:2,text:Se,loading:Me,disabled:ze}),e[71]=Se,e[72]=Me,e[73]=ze,e[74]=O):O=e[74];let U;e[75]===Symbol.for("react.memo_cache_sentinel")?(U={maxWidth:240},e[75]=U):U=e[75];let z;e[76]!==y?(z=()=>y("previewDrafts"),e[76]=y,e[77]=z):z=e[77];const ht=b==="previewDrafts";let ke;e[78]===Symbol.for("react.memo_cache_sentinel")?(ke=c.jsx(te,{flex:"none",children:c.jsx(W,{size:1,children:m.createElement(tr.previewDrafts)})}),e[78]=ke):ke=e[78];let Le;e[79]!==v?(Le=v(tn.previewDrafts),e[79]=v,e[80]=Le):Le=e[80];let De;e[81]!==Le?(De=c.jsx(W,{size:1,weight:"medium",children:Le}),e[81]=Le,e[82]=De):De=e[82];let Ue;e[83]!==v?(Ue=v("preview-frame.perspective.previewDrafts.text"),e[83]=v,e[84]=Ue):Ue=e[84];let We;e[85]!==Ue?(We=c.jsx(W,{muted:!0,size:1,children:Ue}),e[85]=Ue,e[86]=We):We=e[86];let Ne;e[87]!==De||e[88]!==We?(Ne=c.jsxs(je,{flex:1,space:2,children:[De,We]}),e[87]=De,e[88]=We,e[89]=Ne):Ne=e[89];const qt=b==="previewDrafts"?1:0;let qe;e[90]!==qt?(qe={opacity:qt},e[90]=qt,e[91]=qe):qe=e[91];let xt;e[92]===Symbol.for("react.memo_cache_sentinel")?(xt=c.jsx(Ln,{}),e[92]=xt):xt=e[92];let Fe;e[93]!==qe?(Fe=c.jsx(te,{flex:"none",children:c.jsx(W,{muted:!0,size:1,style:qe,children:xt})}),e[93]=qe,e[94]=Fe):Fe=e[94];let Ve;e[95]!==Ne||e[96]!==Fe?(Ve=c.jsxs(J,{align:"flex-start",gap:3,children:[ke,Ne,Fe]}),e[95]=Ne,e[96]=Fe,e[97]=Ve):Ve=e[97];let Ke;e[98]!==z||e[99]!==ht||e[100]!==Ve?(Ke=c.jsx(cn,{fontSize:1,onClick:z,padding:3,pressed:ht,tone:er.previewDrafts,children:Ve}),e[98]=z,e[99]=ht,e[100]=Ve,e[101]=Ke):Ke=e[101];let He;e[102]!==y?(He=()=>y("published"),e[102]=y,e[103]=He):He=e[103];const Ft=b==="published";let wt;e[104]===Symbol.for("react.memo_cache_sentinel")?(wt=c.jsx(te,{flex:"none",children:c.jsx(W,{size:1,children:m.createElement(tr.published)})}),e[104]=wt):wt=e[104];let Be;e[105]!==v?(Be=v(tn.published),e[105]=v,e[106]=Be):Be=e[106];let Ge;e[107]!==Be?(Ge=c.jsx(W,{size:1,weight:"medium",children:Be}),e[107]=Be,e[108]=Ge):Ge=e[108];let Xe;e[109]!==v?(Xe=v("preview-frame.perspective.published.text"),e[109]=v,e[110]=Xe):Xe=e[110];let Je;e[111]!==Xe?(Je=c.jsx(W,{muted:!0,size:1,children:Xe}),e[111]=Xe,e[112]=Je):Je=e[112];let Qe;e[113]!==Ge||e[114]!==Je?(Qe=c.jsxs(je,{flex:1,space:2,children:[Ge,Je]}),e[113]=Ge,e[114]=Je,e[115]=Qe):Qe=e[115];const Vt=b==="published"?1:0;let Ye;e[116]!==Vt?(Ye={opacity:Vt},e[116]=Vt,e[117]=Ye):Ye=e[117];let _t;e[118]===Symbol.for("react.memo_cache_sentinel")?(_t=c.jsx(Ln,{}),e[118]=_t):_t=e[118];let Ze;e[119]!==Ye?(Ze=c.jsx(te,{flex:"none",children:c.jsx(W,{muted:!0,size:1,style:Ye,children:_t})}),e[119]=Ye,e[120]=Ze):Ze=e[120];let et;e[121]!==Qe||e[122]!==Ze?(et=c.jsxs(J,{align:"flex-start",gap:3,children:[wt,Qe,Ze]}),e[121]=Qe,e[122]=Ze,e[123]=et):et=e[123];let tt;e[124]!==He||e[125]!==Ft||e[126]!==et?(tt=c.jsx(cn,{fontSize:1,onClick:He,padding:3,pressed:Ft,tone:er.published,children:et}),e[124]=He,e[125]=Ft,e[126]=et,e[127]=tt):tt=e[127];let nt;e[128]!==Ke||e[129]!==tt?(nt=c.jsxs(dr,{style:U,children:[Ke,tt]}),e[128]=Ke,e[129]=tt,e[130]=nt):nt=e[130];let St;e[131]===Symbol.for("react.memo_cache_sentinel")?(St={animate:!0,constrainSize:!0,placement:"bottom",portal:!0},e[131]=St):St=e[131];let rt;e[132]!==O||e[133]!==nt?(rt=c.jsx(J,{align:"center",flex:"none",gap:1,padding:1,children:c.jsx(lr,{button:O,id:"perspective-menu",menu:nt,popover:St})}),e[132]=O,e[133]=nt,e[134]=rt):rt=e[134];const Kt=E==="desktop"?"narrow":"full";let st;e[135]!==v||e[136]!==Kt?(st=v("preview-frame.viewport-button.tooltip",{context:Kt}),e[135]=v,e[136]=Kt,e[137]=st):st=e[137];let it;e[138]!==st?(it=c.jsx(W,{size:1,children:st}),e[138]=st,e[139]=it):it=e[139];let Pt;e[140]===Symbol.for("react.memo_cache_sentinel")?(Pt=["bottom-start"],e[140]=Pt):Pt=e[140];let at;e[141]!==v?(at=v("preview-frame.viewport-button.aria-label"),e[141]=v,e[142]=at):at=e[142];const Ht=E==="desktop"?Fs:Vs;let ot;e[143]!==at||e[144]!==Ht||e[145]!==k?(ot=c.jsx(be,{"aria-label":at,fontSize:1,icon:Ht,mode:"bleed",onClick:k,padding:2}),e[143]=at,e[144]=Ht,e[145]=k,e[146]=ot):ot=e[146];let ct;e[147]!==it||e[148]!==ot?(ct=c.jsx(J,{align:"center",flex:"none",gap:1,children:c.jsx(dt,{animate:!0,content:it,fallbackPlacements:Pt,padding:2,placement:"bottom",portal:!0,children:ot})}),e[147]=it,e[148]=ot,e[149]=ct):ct=e[149];let lt;e[150]!==n||e[151]!==s||e[152]!==r||e[153]!==l||e[154]!==b||e[155]!==H?(lt=n&&c.jsx(J,{align:"center",flex:"none",gap:1,paddingX:1,children:c.jsx(Dr,{canToggleSharePreviewAccess:s,canUseSharedPreviewAccess:r,previewLocationRoute:H,initialUrl:l,perspective:b})}),e[150]=n,e[151]=s,e[152]=r,e[153]=l,e[154]=b,e[155]=H,e[156]=lt):lt=e[156];let jt;return e[157]!==me||e[158]!==_e||e[159]!==B||e[160]!==rt||e[161]!==ct||e[162]!==lt?(jt=c.jsxs(c.Fragment,{children:[B,me,_e,rt,ct,lt]}),e[157]=me,e[158]=_e,e[159]=B,e[160]=rt,e[161]=ct,e[162]=lt,e[163]=jt):jt=e[163],jt},xo=t=>{var l;const e=L(6),n=_o;let s;e[0]!==t?(s=(l=t.options)!=null&&l.component?m.createElement(t.options.component,{...t,renderDefault:n}):n(t),e[0]=t,e[1]=s):s=e[1];const r=s;let i;e[2]===Symbol.for("react.memo_cache_sentinel")?(i={position:"relative"},e[2]=i):i=e[2];let a;e[3]===Symbol.for("react.memo_cache_sentinel")?(a={minHeight:0},e[3]=a):a=e[3];let o;return e[4]!==r?(o=c.jsx(oe,{flex:"none",padding:2,shadow:1,style:i,children:c.jsx(J,{align:"center",style:a,children:r})}),e[4]=r,e[5]=o):o=e[5],o};function wo(t){const e=L(2);let n;return e[0]!==t?(n=()=>c.jsx(xo,{...t}),e[0]=t,e[1]=n):n=e[1],n}function _o(t){return m.createElement(bo,t)}const nn=bt(J),Ur=m.memo(m.forwardRef(function(t,e){const{dispatch:n,iframe:s,header:r,initialUrl:i,loadersConnection:a,overlaysConnection:o,viewport:l}=t,{t:d}=xe(we),{devMode:p}=mn(),u=rs(),f=m.useRef(null),h=wo({...t,iframeRef:f,options:r});m.useImperativeHandle(e,()=>f.current);const x=s.status==="loading"||s.status==="reloading",[b,g]=m.useState(!1),y=s.status==="refreshing",[_,S]=m.useState(!1),w=x||y||o==="connecting",j=m.useCallback(()=>{f.current&&(f.current.src=i.toString(),n({type:hr}))},[n,i]),E=m.useCallback(()=>{R(!0)},[]),[T,R]=m.useState(!1),[v,P]=m.useState(!1);m.useEffect(()=>{if(!(x||y)&&(o==="connecting"||o==="reconnecting")){const I=setTimeout(()=>{P(!0)},5e3);return()=>clearTimeout(I)}},[o,x,y]),m.useEffect(()=>{if(!(x||y||!v)){if(o==="connected"&&(S(!1),P(!1),g(!1),R(!1)),o==="connecting"){const I=setTimeout(()=>{g(!0),console.error("Unable to connect to visual editing. Make sure you've setup '@sanity/visual-editing' correctly")},Mn);return()=>clearTimeout(I)}if(o==="reconnecting"){const I=setTimeout(()=>{g(!0),S(!0)},Mn);return()=>clearTimeout(I)}o==="disconnected"&&S(!0)}},[x,o,y,v]);const k=m.useCallback(()=>{n({type:fr})},[n]);m.useEffect(()=>{if(!f.current)return;const I=f.current;function A(){I===document.activeElement&&I.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0,cancelable:!0}))}return window.addEventListener("blur",A),()=>{window.removeEventListener("blur",A)}},[]);const C=m.useMemo(()=>(x||o==="connecting"&&s.status!=="refreshing")&&!T,[T,s.status,x,o]),$=m.useMemo(()=>[C?"background":"active",x?"reloading":"idle",l,v&&!T?"timedOut":""],[T,x,C,v,l]);return c.jsx(ti,{transition:u?{duration:0}:void 0,children:c.jsxs(ss,{delay:1e3,children:[c.jsx(h,{}),c.jsx(oe,{flex:1,tone:"transparent",children:c.jsxs(J,{align:"center",height:"fill",justify:"center",padding:l==="desktop"?0:2,sizing:"border",style:{position:"relative",cursor:w?"wait":void 0},children:[c.jsx(pr,{children:!_&&!x&&!y&&v&&!T?c.jsx(nn,{initial:"initial",animate:"animate",exit:"exit",variants:nr,justify:"center",align:"center",style:{inset:"0",position:"absolute",backdropFilter:b?"blur(16px) saturate(0.5) grayscale(0.5)":"blur(2px)",transition:"backdrop-filter 0.2s ease-in-out",WebkitBackdropFilter:b?"blur(16px) saturate(0.5) grayscale(0.5)":"blur(2px)",WebkitTransition:"-webkit-backdrop-filter 0.2s ease-in-out",zIndex:1},children:c.jsxs(J,{style:{...zt[l]},justify:"center",align:"center",direction:"column",gap:4,children:[b&&c.jsx(be,{disabled:!0,fontSize:1,mode:"ghost",text:d("preview-frame.continue-button.text"),style:{opacity:0}}),c.jsx(oe,{radius:2,tone:b?"caution":"inherit",padding:4,shadow:1,children:c.jsxs(J,{justify:"center",align:"center",direction:"column",gap:4,children:[c.jsx(kt,{muted:!0}),c.jsx(W,{muted:!0,size:1,children:b?d("preview-frame.status",{context:"timeout"}):d("preview-frame.status",{context:"connecting"})})]})}),b&&c.jsx(be,{fontSize:1,tone:"critical",onClick:E,text:d("preview-frame.continue-button.text")})]})}):(x||o==="connecting"&&s.status!=="refreshing")&&!T?c.jsx(nn,{initial:"initial",animate:"animate",exit:"exit",variants:nr,justify:"center",align:"center",style:{inset:"0",position:"absolute"},children:c.jsxs(J,{style:{...zt[l]},justify:"center",align:"center",direction:"column",gap:4,children:[c.jsx(kt,{muted:!0}),c.jsx(W,{muted:!0,size:1,children:d("preview-frame.status",{context:"loading"})})]})}):_&&!T?c.jsx(nn,{initial:"initial",animate:"animate",exit:"exit",variants:So,justify:"center",align:"center",style:{background:"var(--card-bg-color)",inset:"0",position:"absolute",borderTop:"1px solid transparent",boxShadow:"0 0 0 1px var(--card-border-color)"},children:c.jsx($n,{flex:1,message:d("preview-frame.connection.error.text"),onRetry:j,onContinueAnyway:E,children:p&&c.jsxs(c.Fragment,{children:[o!=="connected"&&c.jsx(oe,{padding:3,radius:2,tone:"critical",children:c.jsxs(je,{space:3,children:[c.jsx(At,{muted:!0,size:0,children:d("preview-frame.overlay.connection-status.label")}),c.jsx($t,{size:1,children:d("channel.status",{context:o})})]})}),a!=="connected"&&c.jsx(oe,{padding:3,radius:2,tone:"critical",children:c.jsxs(je,{space:3,children:[c.jsx(At,{muted:!0,size:0,children:d("preview-frame.loader.connection-status.label")}),c.jsx($t,{size:1,children:d("channel.status",{context:a})})]})})]})})}):null}),c.jsx(co,{animate:$,initial:["background"],onLoad:k,preventClick:C,ref:f,src:i.toString(),variants:Po})]})})]})})}));Ur.displayName="Memo(ForwardRef(Preview))";const zt={desktop:{width:"100%",height:"100%"},mobile:{width:375,height:650}},nr={initial:{opacity:1},animate:{opacity:[0,0,1]},exit:{opacity:[1,0,0]}},So={initial:{opacity:1},animate:{opacity:[0,0,1]},exit:{opacity:[1,0,0]}},Po={desktop:{...zt.desktop,boxShadow:"0 0 0 0px var(--card-border-color)"},mobile:{...zt.mobile,boxShadow:"0 0 0 1px var(--card-border-color)"},background:{opacity:0,scale:1},idle:{scale:1},reloading:{scale:[1,1,1,.98]},active:{opacity:[0,0,1],scale:1},timedOut:{opacity:[0,0,1]}};function jo(t,e,n,s){const r=L(5),i=m.useRef(n),a=Rs(e);let o,l;r[0]!==a||r[1]!==s||r[2]!==t?(o=()=>{const d=i.current;if(i.current=t,t!==d)return a(t,d)},l=[a,s,t],r[0]=a,r[1]=s,r[2]=t,r[3]=o,r[4]=l):(o=r[3],l=r[4]),m.useEffect(o,l)}const Eo=function(t){const e=L(4),{documentId:n,documentType:s,navigate:r,perspective:i,documentRevision:a}=t,o=Es(n,s);let l;return e[0]!==a||e[1]!==o||e[2]!==r?(l=d=>{let p;if(d==="published"&&o.published){const{_updatedAt:u,_rev:f}=o.published;p=`${u}/${f}`}a!==p&&r({},{rev:p},!0)},e[0]=a,e[1]=o,e[2]=r,e[3]=l):l=e[3],jo(i,l),null};function Ro(){let t=!1;return(...e)=>{t||(console.warn(...e),t=!0)}}const To=Ro();function Co(t,e){if(t!=="published"&&t!=="previewDrafts")throw new Error(`Invalid perspective: ${t}`);const[n,s]=m.useState({}),[r,i]=m.useState({}),a=m.useRef(""),o=m.useCallback((l,d,p=[])=>{const u=p.filter(f=>"_projectId"in f&&f._projectId?(To("Cross dataset references are not supported yet, ignoring source document",f),!1):f);(d==="published"?s:i)(f=>{const h={};for(const b of u)h[b._id]=b;if(a.current!==e.current.url)return a.current=e.current.url,{[l]:h};const x=f[l];return Zs(x,h)?f:{...f,[l]:h}})},[e]);return[m.useMemo(()=>{const l=Object.values(t==="published"?n:r).reduce((d,p)=>(Object.values(p).forEach(u=>{d[u._id]=u}),d),{});return Object.values(l)},[t,r,n]),o]}function Wr(t,e){return t instanceof Function?t(e):t}function Io(t,e){var n;if(t.resolve){const s=(n=t.resolve(e))==null?void 0:n.filter;return s?`*[${s}][0]{_id, _type}`:void 0}return"type"in t?`*[_type == "${t.type}"][0]{_id, _type}`:`*[${Wr(t.filter,e)}][0]{_id, _type}`}function ko(t,e){var n;return t.resolve?((n=t.resolve(e))==null?void 0:n.params)??e.params:"type"in t?{}:Wr(t.params,e)??e.params}function Ao(t,e){const n=Array.isArray(t)?t:[t];for(t of n){let s,r=t;if(typeof t=="string")try{const i=new URL(t);s=i.origin,r=i.pathname}catch{}if(!(s&&e.origin!==s))try{const i=Li(r,{decode:decodeURIComponent})(e.pathname);if(i){const{params:a,path:o}=i;return{origin:s,params:a,path:o}}}catch{throw new Error(`"${t}" is not a valid route pattern`)}}}function $o(t){const{navigate:e,navigationHistory:n,path:s,previewUrl:r,resolvers:i=[]}=t,{state:a}=vn(),o=Dt({apiVersion:Ut}),[l,d]=m.useState(void 0),p=m.useRef(void 0),u=m.useMemo(()=>{var b,g;const h=s||((g=(b=a._searchParams)==null?void 0:b.find(([y])=>y==="preview"))==null?void 0:g[1])||"",x=typeof r=="string"?r:typeof r=="object"&&(r==null?void 0:r.origin)||location.origin;return new URL(h,x)},[s,r,a._searchParams]),f=m.useCallback(()=>{d(void 0),p.current=void 0},[]);return m.useEffect(()=>{if(i.length&&u){let h;for(const x of i){const b=Ao(x.route,u);if(b){h={context:b,resolver:x};break}}if(h){const x=Io(h.resolver,h.context),b=ko(h.resolver,h.context);if(x){const g=new AbortController,y={perspective:"previewDrafts",signal:g.signal};return o.fetch(x,b,y).then(_=>{var S,w;(!_||p.current!==_._id)&&(d({document:_,path:u.pathname}),p.current=_==null?void 0:_._id,((S=n.at(-1))==null?void 0:S.id)===((w=n.at(-2))==null?void 0:w.id)&&(e==null||e({id:_==null?void 0:_._id,type:_==null?void 0:_._type})))}).catch(_=>{_ instanceof Error&&_.name==="AbortError"||(d({document:void 0,path:u.pathname}),p.current=void 0)}),()=>{g.abort()}}}}f()},[o,f,e,n,i,u]),l}function Oo(t){var n;if(t===void 0)return;const e=(n=decodeURIComponent(t))==null?void 0:n.split(".");return e[0]==="drafts"&&e.shift(),e.join(".")}function Mo(t){if(t!==void 0)return Rr.toString(Qi(decodeURIComponent(t)))}function zo(t){return{id:Oo(t.id),path:Mo(t.path),type:t.type}}function It(t){return Object.fromEntries(Object.entries(t).filter(([,e])=>e!==void 0&&e!==""&&e!==null))}function Lo({initialPreviewUrl:t,routerNavigate:e,routerState:n,routerSearchParams:s,frameStateRef:r}){const i=m.useMemo(()=>{const{id:u,path:f,type:h}=zo(n);return{id:u,type:h,path:f,preview:s.preview||`${t.pathname}${t.search}`,perspective:s.perspective,viewport:s.viewport,inspect:s.inspect,rev:s.rev,since:s.since,template:s.template,templateParams:s.templateParams,view:s.view,pathKey:s.pathKey,instruction:s.instruction,comment:s.comment,changesInspectorTab:s.changesInspectorTab}},[n,s,t]),a=m.useMemo(()=>It({inspect:i.inspect,path:i.path,rev:i.rev,since:i.since,template:i.template,templateParams:i.templateParams,view:i.view,pathKey:i.pathKey,instruction:i.instruction,comment:i.comment,changesInspectorTab:i.changesInspectorTab}),[i.changesInspectorTab,i.comment,i.inspect,i.instruction,i.path,i.pathKey,i.rev,i.since,i.template,i.templateParams,i.view]),o=m.useMemo(()=>It({perspective:i.perspective,preview:i.preview,viewport:i.viewport}),[i.perspective,i.preview,i.viewport]),l=m.useRef(n);m.useEffect(()=>{l.current=n},[n]);const[d,p]=m.useState([n]);return{navigate:m.useCallback((u,f={},h)=>{u.id&&(u.id=yn(u.id));const{_searchParams:x,...b}=l.current,g=(x||[]).reduce((w,[j,E])=>(w[j]=E,w),{}),y=It({...b,...u}),_=It({...g,...f});b.id!==y.id&&(delete _.template,delete _.templateParams),y._searchParams=Object.entries(_).reduce((w,[j,E])=>[...w,[j,E]],[]);const S=h??_.preview===r.current.url;p(w=>[...w,y]),e(y,{replace:S})},[e,r]),navigationHistory:d,params:i,searchParams:o,structureParams:a}}const Do=t=>{const e=L(10),[n,s]=m.useState(Uo);let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=u=>{const f=window.open(u,"_blank");f&&s(h=>new Set(h).add(f))},e[0]=r):r=e[0];const i=r;let a,o;e[1]!==t||e[2]!==n?(a=()=>{const u=[];if(n.size&&t)for(const f of n)f&&"closed"in f&&!f.closed&&u.push(t.addTarget(f));return()=>{u.forEach(Wo)}},o=[t,n],e[1]=t,e[2]=n,e[3]=a,e[4]=o):(a=e[3],o=e[4]),m.useEffect(a,o);let l,d;e[5]!==n?(l=()=>{if(n.size){const u=setInterval(()=>{const f=new Set;for(const h of n)h&&"closed"in h&&h.closed&&f.add(h);f.size&&s(h=>{const x=new Set(h);for(const b of f)x.delete(b);return x})},Ts);return()=>{clearInterval(u)}}},d=[n],e[5]=n,e[6]=l,e[7]=d):(l=e[6],d=e[7]),m.useEffect(l,d);let p;return e[8]!==n?(p={popups:n,open:i},e[8]=n,e[9]=p):p=e[9],p};function Uo(){return new Set}function Wo(t){return t()}function No(t,e,n,s,r){var u,f;const i=Dt({apiVersion:Ut}),a=yr(),o=((u=a==null?void 0:a.activeWorkspace)==null?void 0:u.basePath)||"/",l=((f=a==null?void 0:a.activeWorkspace)==null?void 0:f.name)||"default",d=Fo(e,o,l,s),p=Vo(r&&typeof t=="object"||typeof t=="function",d);return kr(async()=>{if(typeof t=="string"){const x=new URL(t,location.origin);let b=x;try{if(s){const g=new URL(s,x);g.origin===x.origin&&(b=g)}}catch{}return location.origin===b.origin&&(b.pathname.startsWith(`${o}/`)||b.pathname===o)?x:b}const h=await(typeof t=="object"?Vi(t):t)({client:i,previewUrlSecret:p,studioPreviewPerspective:n,previewSearchParam:s,studioBasePath:o});return new URL(h,location.origin)},[...d,p])}const qo=Symbol();function Fo(t,e,n,s){const r=L(12);let i;r[0]!==s?(i=()=>s||"",r[0]=s,r[1]=i):i=r[1];const[a,o]=m.useState(i),l=m.useRef(0);let d,p;r[2]!==a||r[3]!==s?(d=()=>{if(a&&s)return window.clearTimeout(l.current),()=>{l.current=window.setTimeout(()=>{o("")},100)}},p=[a,s],r[2]=a,r[3]=s,r[4]=d,r[5]=p):(d=r[4],p=r[5]),m.useEffect(d,p);const u=fn();let f;const h=u==null?void 0:u.id;let x;return r[6]!==e||r[7]!==a||r[8]!==h||r[9]!==t||r[10]!==n?(x=["@sanity/presentation",e,n,t,h,qo,a],r[6]=e,r[7]=a,r[8]=h,r[9]=t,r[10]=n,r[11]=x):x=r[11],f=x,f}function Vo(t,e){const n=L(10);let s;n[0]===Symbol.for("react.memo_cache_sentinel")?(s={apiVersion:Ut},n[0]=s):s=n[0];const r=Dt(s),i=fn(),[a,o]=m.useState("");let l;n[1]!==r||n[2]!==(i==null?void 0:i.id)||n[3]!==e||n[4]!==t||n[5]!==a?(l=t?kr(async()=>await Fi(r,"@sanity/presentation",typeof window>"u"?"":location.href,i==null?void 0:i.id),[...e,a]):null,n[1]=r,n[2]=i==null?void 0:i.id,n[3]=e,n[4]=t,n[5]=a,n[6]=l):l=n[6];const d=l;let p,u;return n[7]!==d?(p=()=>{if(!d)return;const f=setTimeout(()=>{m.startTransition(()=>o(d.expiresAt.toString()))},d.expiresAt.getTime()-Date.now());return()=>clearTimeout(f)},u=[d],n[7]=d,n[8]=p,n[9]=u):(p=n[8],u=n[9]),m.useEffect(p,u),(d==null?void 0:d.secret)||null}function rn(){const t=L(4);let e;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=new Map,t[0]=e):e=t[0];const[n,s]=m.useState(e);let r;e:{const d=Array.from(n.values());if(d.find(Bo)){r="connected";break e}const p=d.filter(Ho);if(p.length){r=p.some(Ko)?"connecting":"reconnecting";break e}r="idle"}const i=r;let a;t[1]===Symbol.for("react.memo_cache_sentinel")?(a=d=>{s(p=>{var f;const u=new Map(p);if(d.status==="disconnected")u.delete(d.channel);else{const h=((f=u.get(d.channel))==null?void 0:f.hasConnected)||d.status==="connected";u.set(d.channel,{status:d.status,hasConnected:h})}return u})},t[1]=a):a=t[1];const o=a;let l;return t[2]!==i?(l=[i,o],t[2]=i,t[3]=l):l=t[3],l}function Ko(t){const{hasConnected:e}=t;return!e}function Ho(t){const{status:e}=t;return e==="handshaking"}function Bo(t){const{status:e}=t;return e==="connected"}const Go=m.lazy(()=>Ee(()=>import("./LoaderQueries-21455851.js"),["static/LoaderQueries-21455851.js","static/sanity-3b6b2486.js","static/hooks-0759ae97.js","static/DisplayedDocumentBroadcaster-97a89245.js"]));m.lazy(()=>Ee(()=>import("./LiveQueries-d2a57574.js"),["static/LiveQueries-d2a57574.js","static/sanity-3b6b2486.js","static/hooks-0759ae97.js","static/DisplayedDocumentBroadcaster-97a89245.js"]));const Xo=m.lazy(()=>Ee(()=>import("./PostMessageDocuments-29131e03.js"),["static/PostMessageDocuments-29131e03.js","static/sanity-3b6b2486.js"])),Jo=m.lazy(()=>Ee(()=>import("./PostMessageFeatures-817bb8f1.js"),["static/PostMessageFeatures-817bb8f1.js","static/sanity-3b6b2486.js"])),Qo=m.lazy(()=>Ee(()=>import("./PostMessageRefreshMutations-774f64e1.js"),["static/PostMessageRefreshMutations-774f64e1.js","static/sanity-3b6b2486.js"])),Yo=m.lazy(()=>Ee(()=>import("./PostMessagePerspective-235424ff.js"),["static/PostMessagePerspective-235424ff.js","static/sanity-3b6b2486.js"])),Zo=m.lazy(()=>Ee(()=>import("./PostMessagePreviewSnapshots-08efa9b6.js"),["static/PostMessagePreviewSnapshots-08efa9b6.js","static/sanity-3b6b2486.js"])),ec=m.lazy(()=>Ee(()=>import("./PostMessageSchema-0d55452a.js"),["static/PostMessageSchema-0d55452a.js","static/sanity-3b6b2486.js"])),tc=pe(J)`
  overflow-x: auto;
`;function nc(t){var _e,Oe,Se,Me,ze;const{canCreateUrlPreviewSecrets:e,canToggleSharePreviewAccess:n,canUseSharedPreviewAccess:s,tool:r}=t,i=(_e=r.options)==null?void 0:_e.components,a=(Oe=r.options)==null?void 0:Oe.previewUrl,o=r.name||ps,{unstable_navigator:l,unstable_header:d}=i||{},{navigate:p,state:u}=vn(),f=gr(Object.fromEntries(u._searchParams||[])),h=No(a||"/",o,f.perspective==="published"?"published":"previewDrafts",f.preview||null,e),x=m.useMemo(()=>a&&typeof a=="object"&&"draftMode"in a&&a.draftMode?(console.warn("previewUrl.draftMode is deprecated, use previewUrl.previewMode instead"),a.draftMode.shareAccess!==!1):a&&typeof a=="object"&&"previewMode"in a&&a.previewMode?a.previewMode.shareAccess!==!1:!1,[a]),[b]=m.useState(()=>{var U;const O=(U=r.options)==null?void 0:U.devMode;return typeof O=="function"?O():typeof O=="boolean"?O:typeof window<"u"&&window.location.hostname==="localhost"}),g=m.useMemo(()=>h.origin,[h.origin]),y=m.useRef(null),[_,S]=m.useState(),[w,j]=m.useState(null),E=m.useRef({title:void 0,url:void 0}),{navigate:T,navigationHistory:R,params:v,searchParams:P,structureParams:k}=Lo({initialPreviewUrl:h,routerNavigate:p,routerState:u,routerSearchParams:f,frameStateRef:E}),C=m.useMemo(()=>Ar(T,50),[T]),[$,I]=m.useReducer(hs,{},fs),A=m.useMemo(()=>v.perspective?"published":"previewDrafts",[v.perspective]),D=m.useMemo(()=>v.viewport?"mobile":"desktop",[v.viewport]),[M,q]=Co(A,E),G=ms(),H=gs(),B=$o({navigate:T,navigationHistory:R,path:v.preview,previewUrl:(Se=r.options)==null?void 0:Se.previewUrl,resolvers:(ze=(Me=r.options)==null?void 0:Me.resolve)==null?void 0:ze.mainDocuments}),[re,he]=rn(),[ie,ce]=rn(),[le,ne]=rn(),{open:fe}=Do(_),N=$.iframe.status==="loading";m.useEffect(()=>{var z;const O=(z=y.current)==null?void 0:z.contentWindow;if(!O||N)return;const U=bi({targetOrigin:g});return U.addTarget(O),S(U),()=>{U.destroy(),S(void 0)}},[g,N]),m.useEffect(()=>{if(!_)return;const O=_.createConnection({name:"presentation",heartbeat:!0,connectTo:"visual-editing"},Mt().provide({actors:ln()}));O.on("visual-editing/focus",z=>{"id"in z&&C({type:z.type,id:z.id,path:z.path})}),O.on("visual-editing/navigate",z=>{const{title:ht,url:ke}=z;E.current.url!==ke&&C({},{preview:ke}),E.current={title:ht,url:ke}}),O.on("visual-editing/meta",z=>{E.current.title=z.title}),O.on("visual-editing/toggle",z=>{I({type:vs,enabled:z.enabled})}),O.on("visual-editing/documents",z=>{q("visual-editing",z.perspective,z.documents)}),O.on("visual-editing/refreshing",z=>{z.source==="manual"?clearTimeout(ve.current):z.source==="mutation"&&I({type:zn})}),O.on("visual-editing/refreshed",()=>{I({type:fr})}),O.onStatus(he);const U=O.start();return j(O),()=>{U(),j(null)}},[_,C,q,he,g]),m.useEffect(()=>{if(!_)return;const O=_.createConnection({name:"presentation",connectTo:"preview-kit",heartbeat:!0},Mt().provide({actors:ln()}));return O.onStatus(ne),O.on("preview-kit/documents",U=>{U.projectId===G&&U.dataset===H&&q("preview-kit",U.perspective,U.documents)}),O.start()},[_,H,G,q,ne,g]);const V=m.useCallback(O=>{C({path:Rr.toString(O)},{},!0)},[C]),F=m.useCallback(O=>{const U=new URL(O,h.origin),z=U.pathname+U.search;U.origin===h.origin&&z!==v.preview&&C({},{preview:z})},[h,v,C]),X=m.useCallback(O=>{C({},O)},[C]);m.useEffect(()=>{v.id&&v.path?w==null||w.post({type:"presentation/focus",data:{id:v.id,path:v.path}}):w==null||w.post({type:"presentation/blur",data:void 0})},[v.id,v.path,w]),m.useEffect(()=>{E.current.url&&v.preview&&E.current.url!==v.preview&&(E.current.url=v.preview,re!=="connected"&&y.current?y.current.src=`${g}${v.preview}`:w==null||w.post({type:"presentation/navigate",data:{url:v.preview,type:"replace"}}))},[re,g,v.preview,w]);const K=m.useCallback(()=>w==null?void 0:w.post({type:"presentation/toggle-overlay",data:void 0}),[w]),[ae,Y]=m.useState(null);m.useEffect(()=>{const O=z=>{Gn(z)&&K()},U=z=>{Gn(z)&&K(),ia(["mod","\\"],z)&&K()};return window.addEventListener("keydown",U),window.addEventListener("keyup",O),()=>{window.removeEventListener("keydown",U),window.removeEventListener("keyup",O)}},[K]);const[Q,se]=m.useState(null),[{navigatorEnabled:de,toggleNavigator:me},ge]=eo({unstable_navigator:l}),ue=m.useRef(v.id);m.useEffect(()=>{v.rev&&ue.current&&v.id!==ue.current&&C({},{rev:void 0}),ue.current=v.id});const ve=m.useRef(),ye=m.useCallback(O=>{if(I({type:zn}),w){ve.current=window.setTimeout(O,300),w.post({type:"presentation/refresh",data:{source:"manual",livePreviewEnabled:le==="connected"||ie==="connected"}});return}O()},[ie,le,w]),Re=ys(),Te=m.useCallback(({id:O,type:U,path:z})=>{if(E.current.url)return{title:E.current.title||E.current.url,name:"edit",params:{id:O,path:z,type:U,inspect:bs,workspace:Re.name,mode:xs,preview:v.preview}}},[v.preview,Re.name]),Ce=m.useCallback(O=>{C({},{viewport:O==="desktop"?void 0:"mobile"},!0)},[C]),Ie=m.useCallback(O=>{C({},{perspective:O==="previewDrafts"?void 0:O})},[C]);return c.jsxs(c.Fragment,{children:[c.jsx(io,{devMode:b,name:o,navigate:C,params:v,searchParams:P,structureParams:k,children:c.jsx(Ya,{navigate:C,children:c.jsx(so,{params:v,children:c.jsx(aa,{comlink:w,children:c.jsx(tc,{height:"fill",children:c.jsxs(va,{children:[c.jsx(ge,{}),c.jsx(An,{id:"preview",minWidth:325,defaultSize:de?50:75,order:3,children:c.jsx(J,{direction:"column",flex:1,height:"fill",ref:se,children:c.jsx(ws,{element:Q,children:c.jsx(Ur,{canSharePreviewAccess:x,canToggleSharePreviewAccess:n,canUseSharedPreviewAccess:s,dispatch:I,header:d,iframe:$.iframe,initialUrl:h,loadersConnection:ie,navigatorEnabled:de,onPathChange:F,onRefresh:ye,openPopup:fe,overlaysConnection:re,previewUrl:v.preview,perspective:A,ref:y,setPerspective:Ie,setViewport:Ce,targetOrigin:g,toggleNavigator:me,toggleOverlay:K,viewport:D,visualEditing:$.visualEditing})})})}),c.jsx(Qa,{documentId:v.id,documentsOnPage:M,documentType:v.type,getCommentIntent:Te,mainDocumentState:B,onFocusPath:V,onStructureParams:X,searchParams:P,setDisplayedDocument:Y,structureParams:k})]})})})})})}),_&&c.jsx(m.Suspense,{children:c.jsx(Go,{controller:_,perspective:A,liveDocument:ae,onDocumentsOnPage:q,onLoadersConnection:ce,documentsOnPage:M})}),w&&v.id&&v.type&&c.jsx(m.Suspense,{children:c.jsx(Qo,{comlink:w,id:v.id,type:v.type,loadersConnection:ie,previewKitConnection:le})}),w&&c.jsx(m.Suspense,{children:c.jsx(ec,{comlink:w,perspective:A})}),w&&M.length>0&&c.jsx(m.Suspense,{children:c.jsx(Zo,{comlink:w,perspective:A,refs:M})}),w&&c.jsx(m.Suspense,{children:c.jsx(Xo,{comlink:w})}),w&&c.jsx(m.Suspense,{children:c.jsx(Jo,{comlink:w})}),w&&c.jsx(m.Suspense,{children:c.jsx(Yo,{comlink:w,perspective:A})}),v.id&&v.type&&c.jsx(Eo,{documentId:v.id,documentRevision:v.rev,documentType:v.type,navigate:C,perspective:A})]})}function rc(t){const e=L(16),{t:n}=xe(we),{previewUrl:s}=t.tool.options??{},{push:r}=cr(),i=typeof s=="object"||typeof s=="function",a=os(),[o,l]=m.useState(null),[d,p]=m.useState(null),[u,f]=m.useState(null),[h,x]=m.useState(null);let b,g;e[0]!==a||e[1]!==i?(b=()=>{if(!i)return;const R=a.checkDocumentPermission("create",{_id:$e,_type:ut}).subscribe(l),v=a.checkDocumentPermission("update",{_id:$e,_type:ut}).subscribe(p),P=a.checkDocumentPermission("read",{_id:$e,_type:ut}).subscribe(f),k=a.checkDocumentPermission("create",{_id:`drafts.${ar()}`,_type:bn}).subscribe(x);return()=>{R.unsubscribe(),v.unsubscribe(),P.unsubscribe(),k.unsubscribe()}},g=[a,i],e[0]=a,e[1]=i,e[2]=b,e[3]=g):(b=e[2],g=e[3]),m.useEffect(b,g);const y=h==null?void 0:h.granted;let _,S;if(e[4]!==y||e[5]!==r||e[6]!==n||e[7]!==i?(_=()=>{if(!i||y!==!1)return;const R=requestAnimationFrame(()=>r({closable:!0,status:"error",duration:3e4,title:n("preview-url-secret.missing-grants")}));return()=>cancelAnimationFrame(R)},S=[y,r,n,i],e[4]=y,e[5]=r,e[6]=n,e[7]=i,e[8]=_,e[9]=S):(_=e[8],S=e[9]),m.useEffect(_,S),i&&(!o||typeof o.granted>"u"||!d||typeof d.granted>"u"||!h||!u||typeof u.granted>"u"||typeof h.granted>"u")){let R;return e[10]===Symbol.for("react.memo_cache_sentinel")?(R=c.jsx(vr,{}),e[10]=R):R=e[10],R}const w=y===!0,j=(o==null?void 0:o.granted)===!0&&(d==null?void 0:d.granted)===!0,E=(u==null?void 0:u.granted)===!0;let T;return e[11]!==t||e[12]!==w||e[13]!==j||e[14]!==E?(T=c.jsx(nc,{...t,canCreateUrlPreviewSecrets:w,canToggleSharePreviewAccess:j,canUseSharedPreviewAccess:E}),e[11]=t,e[12]=w,e[13]=j,e[14]=E,e[15]=T):T=e[15],T}var sc=Object.freeze({__proto__:null,default:rc});const dc=Object.freeze(Object.defineProperty({__proto__:null,PresentationToolGrantsCheck:sc,createCompatibilityActors:ln,getQueryCacheKey:ra},Symbol.toStringTag,{value:"Module"}));export{Fn as D,dc as P,ln as a,oc as b,Mt as c,_i as d,ra as g,cc as p,lc as r,Si as t,mt as w};
