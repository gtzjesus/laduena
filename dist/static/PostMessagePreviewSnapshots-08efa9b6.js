import{Y as w,Z as g,r as o,b_ as P,a5 as _,cv as S,aB as x,cw as E,cx as M,cy as k,aG as y,bR as v,cu as R,b7 as D,b2 as U,al as $,cz as j}from"./sanity-3b6b2486.js";function F(u){return w(function(p,t){var a=!1,r=0;p.subscribe(g(t,function(e){return(a||(a=!u(e,r++)))&&t.next(e)}))})}const I=u=>{const{comlink:p,refs:t,perspective:a}=u,r=P(),e=_(),c=o.useMemo(()=>new S,[]),d=o.useMemo(()=>c.asObservable().pipe(x(b=>E(b.map(s=>{const l={...s,_id:M(s._id)},m=a==="previewDrafts"?r.observeForPreview(l,e.get(l._type)).pipe(k(),F(i=>i.snapshot===null)):y,f={...s,_id:v(s._id)},h=r.observeForPreview(f,e.get(f._type));return R(h.pipe(D(m)),m).pipe(U(i=>!!i.snapshot),$(i=>{const n=i.snapshot;return{_id:v(n._id),title:n.title,subtitle:n.subtitle,description:n.description,imageUrl:n.imageUrl}}))}))),j(0)),[r,c,e,a]);return o.useEffect(()=>{const b=d.subscribe(s=>{p.post({type:"presentation/preview-snapshots",data:{snapshots:s}})});return()=>{b.unsubscribe()}},[p,d]),o.useEffect(()=>{c.next(t)},[t,c]),null};var z=o.memo(I);export{z as default};
